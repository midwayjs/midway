<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-extensions/security">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="Midway RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="Midway Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Midway" href="/en/opensearch.xml">
<link rel="stylesheet" href="//at.alicdn.com/t/font_2797741_dnh1sm1jan.css"><title data-rh="true">å®‰å…¨ | Midway</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://midwayjs.org/en/docs/extensions/security"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="referrer" content="no-referrer"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="å®‰å…¨ | Midway"><meta data-rh="true" name="description" content="é€‚ç”¨äº @midwayjs/faas ã€@midwayjs/web ã€@midwayjs/koa å’Œ @midwayjs/express å¤šç§æ¡†æ¶çš„é€šç”¨å®‰å…¨ç»„ä»¶ï¼Œæ”¯æŒ csrf ã€xss ç­‰å¤šç§å®‰å…¨ç­–ç•¥ã€‚"><meta data-rh="true" property="og:description" content="é€‚ç”¨äº @midwayjs/faas ã€@midwayjs/web ã€@midwayjs/koa å’Œ @midwayjs/express å¤šç§æ¡†æ¶çš„é€šç”¨å®‰å…¨ç»„ä»¶ï¼Œæ”¯æŒ csrf ã€xss ç­‰å¤šç§å®‰å…¨ç­–ç•¥ã€‚"><link data-rh="true" rel="icon" href="/en/img/logo.svg"><link data-rh="true" rel="canonical" href="https://midwayjs.org/en/docs/extensions/security"><link data-rh="true" rel="alternate" href="https://midwayjs.org/docs/extensions/security" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://midwayjs.org/en/docs/extensions/security" hreflang="en"><link data-rh="true" rel="alternate" href="https://midwayjs.org/docs/extensions/security" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://DHOMYJQQ2W-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/en/assets/css/styles.8a6db1c9.css">
<link rel="preload" href="/en/assets/js/runtime~main.4af01d91.js" as="script">
<link rel="preload" href="/en/assets/js/main.a34cf7fc.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="midway logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/en/img/logo.svg" alt="midway logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Midway</b></a><a class="navbar__item navbar__link" href="/en/docs/intro">æ ‡å‡†é¡¹ç›®</a><a class="navbar__item navbar__link" href="/en/docs/hooks/intro">å‡½æ•°å¼ &amp; ä¸€ä½“åŒ–</a><a class="navbar__item navbar__link" href="/en/docs/serverless/serverless_intro">Serverless</a><a class="navbar__item navbar__link navbar__link--active" href="/en/docs/extensions/axios">ç»„ä»¶ &amp; æ‰©å±•</a><a class="navbar__item navbar__link" href="/en/docs/tool/cli">å·¥å…· &amp; å…¶ä»–</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/en/docs/intro">3.0.0</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/en/docs/extensions/security">3.0.0</a></li><li><a class="dropdown__link" href="/en/docs/2.0.0/intro">2.0.0</a></li><li><a class="dropdown__link" href="/en/docs/1.0.0/intro">1.0.0</a></li></ul></div><a href="https://survey.taobao.com/apps/zhiliao/pJ3zng9Iv" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">å¼€æºé€ç¤¼<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://subway.midwayjs.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">çº¿ä¸‹æ²™é¾™<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/midwayjs/midway" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist-caret">é€šç”¨</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/axios">HTTP è¯·æ±‚</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/i18n">å¤šè¯­è¨€</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/info">ä¿¡æ¯æŸ¥çœ‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/validate">å‚æ•°æ ¡éªŒ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/swagger">Swagger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/task">ä»»åŠ¡è°ƒåº¦</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/jwt">JWT</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist-caret menu__link--active">Http æœåŠ¡</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/koa">Koa</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/egg">EggJS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/express">Express</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/extensions/security">å®‰å…¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/render">æ¨¡æ¿æ¸²æŸ“</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/upload">æ–‡ä»¶ä¸Šä¼ </a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/passport">èº«ä»½éªŒè¯</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/static_file">é™æ€æ–‡ä»¶æ‰˜ç®¡</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/cross_domain">è·¨åŸŸ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/http-proxy">HTTP ä»£ç†</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist-caret">æ•°æ®å­˜å‚¨</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/orm">TypeORM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/sequelize">Sequelize</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/redis">Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/mongodb">MongoDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/cache">ç¼“å­˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/oss">é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨ï¼ˆOSSï¼‰</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/cos">è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨ï¼ˆCOSï¼‰</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/tablestore">TableStore</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/mikro">MikroORM</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist-caret">å¾®æœåŠ¡</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/grpc">gRPC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/consul">Consul</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist-caret">WebSocket</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/socketio">SocketIO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/ws">WebSocket</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist-caret">æ¶ˆæ¯</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/rabbitmq">RabbitMQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist-caret">ç›‘æ§å’Œå¯åŠ¨</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/otel">é“¾è·¯è¿½è¸ª</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/pm2">pm2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/cfork">cfork</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/alinode">Alinode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/extensions/prometheus">Prometheus</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/en/">ğŸ </a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">Http æœåŠ¡</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">å®‰å…¨</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 3.0.0</span><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>å®‰å…¨</h1><p>é€‚ç”¨äº <code>@midwayjs/faas</code> ã€<code>@midwayjs/web</code> ã€<code>@midwayjs/koa</code> å’Œ <code>@midwayjs/express</code> å¤šç§æ¡†æ¶çš„é€šç”¨å®‰å…¨ç»„ä»¶ï¼Œæ”¯æŒ <code>csrf</code> ã€<code>xss</code> ç­‰å¤šç§å®‰å…¨ç­–ç•¥ã€‚</p><p>ç›¸å…³ä¿¡æ¯ï¼š</p><table><thead><tr><th>web æ”¯æŒæƒ…å†µ</th><th></th></tr></thead><tbody><tr><td>@midwayjs/koa</td><td>âœ…</td></tr><tr><td>@midwayjs/faas</td><td>âœ…</td></tr><tr><td>@midwayjs/web</td><td>âœ…</td></tr><tr><td>@midwayjs/express</td><td>âœ…</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="å®‰è£…ä½¿ç”¨">å®‰è£…ä½¿ç”¨<a class="hash-link" href="#å®‰è£…ä½¿ç”¨" title="Direct link to heading">â€‹</a></h2><p>1ã€å®‰è£…ä¾èµ–</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> i @midwayjs/security --save</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>æˆ–è€…åœ¨ <code>package.json</code> ä¸­å¢åŠ å¦‚ä¸‹ä¾èµ–åï¼Œé‡æ–°å®‰è£…ã€‚</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;dependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;@midwayjs/security&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^3.0.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;devDependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>2ã€åœ¨ configuration ä¸­å¼•å…¥ç»„ä»¶</p><div class="codeBlockContainer_I0IT language-typescript theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-typescript codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports operator" style="color:#393A34">*</span><span class="token imports"> </span><span class="token imports keyword module" style="color:#00009f">as</span><span class="token imports"> security</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@midwayjs/security&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Configuration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  imports</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...other components</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    security</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">MainConfiguration</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="é˜²èŒƒå¸¸è§çš„å®‰å…¨å¨èƒ">é˜²èŒƒå¸¸è§çš„å®‰å…¨å¨èƒ<a class="hash-link" href="#é˜²èŒƒå¸¸è§çš„å®‰å…¨å¨èƒ" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="ä¸€csrf">ä¸€ã€CSRF<a class="hash-link" href="#ä¸€csrf" title="Direct link to heading">â€‹</a></h3><p>CSRFï¼ˆCross-site request forgery è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰ï¼Œæ˜¯ä¸€ç§æŒŸåˆ¶ç”¨æˆ·åœ¨å½“å‰å·²ç™»å½•çš„Webåº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéæœ¬æ„çš„æ“ä½œçš„æ”»å‡»æ–¹æ³•ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="1-ä»¤ç‰ŒåŒæ­¥æ¨¡å¼">1. ä»¤ç‰ŒåŒæ­¥æ¨¡å¼<a class="hash-link" href="#1-ä»¤ç‰ŒåŒæ­¥æ¨¡å¼" title="Direct link to heading">â€‹</a></h4><p>é€šè¿‡å“åº”é¡µé¢æ—¶å°† token æ¸²æŸ“åˆ°é¡µé¢ä¸Šï¼Œåœ¨å¼€å¯ <code>csrf</code> é…ç½®åï¼Œé€šè¿‡ <code>ctx.csrf</code> å¯ä»¥è·å–åˆ° <code>csrf token</code>ï¼Œå¯ä»¥å†è¿”å›é¡µé¢ html æ—¶åŒæ­¥è¾“å‡º</p><div class="codeBlockContainer_I0IT language-ts theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-ts codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Controller</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">HomeController</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Inject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ctx</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/home&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">home</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">&lt;form method=&quot;POST&quot; action=&quot;/upload?_csrf=</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation keyword" style="color:#00009f">this</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation property-access">ctx</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation property-access">csrf</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">&quot; &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">      title: &lt;input name=&quot;title&quot; /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">      &lt;button type=&quot;submit&quot;&gt;upload&lt;/button&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    &lt;/form&gt;</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ä¼ é€’ CSRF token çš„å­—æ®µï¼ˆä¸Šè¿°ç¤ºä¾‹ä¸­çš„ <code>_csrf</code>ï¼‰å¯ä»¥åœ¨é…ç½®ä¸­æ”¹å˜ï¼Œè¯·æŸ¥çœ‹ä¸‹è¿° <code>é…ç½® -&gt; csrf</code>ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="2-cookies-æ¨¡å¼">2. Cookies æ¨¡å¼<a class="hash-link" href="#2-cookies-æ¨¡å¼" title="Direct link to heading">â€‹</a></h4><p>åœ¨ CSRF é»˜è®¤é…ç½®ä¸‹ï¼Œtoken ä¼šè¢«è®¾ç½®åœ¨ Cookie ä¸­ï¼Œå¯ä»¥å†å‰ç«¯é¡µé¢ä¸­é€šè¿‡ JS ä» Cookies ä¸­è·å–ï¼Œç„¶åå† ajax/fetch ç­‰è¯·æ±‚ä¸­æ·»åŠ åˆ° <code>header</code>ã€<code>query</code> æˆ– <code>body</code> ä¸­ã€‚</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> csrftoken </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Cookies</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;csrfToken&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/api/post&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">method</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;POST&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">headers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&#x27;x-csrf-token&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> csrftoken</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>é»˜è®¤é…ç½®ä¸‹ï¼Œæ¡†æ¶ä¼šå°† <code>CSRF token</code> å­˜åœ¨ <code>Cookie</code> ä¸­ï¼Œä»¥æ–¹ä¾¿å‰ç«¯ JS å‘èµ·è¯·æ±‚æ—¶è·å–åˆ°ã€‚ä½†æ˜¯æ‰€æœ‰çš„å­åŸŸåéƒ½å¯ä»¥è®¾ç½® Cookieï¼Œå› æ­¤å½“æˆ‘ä»¬çš„åº”ç”¨å¤„äºæ— æ³•ä¿è¯æ‰€æœ‰çš„å­åŸŸåéƒ½å—æ§çš„æƒ…å†µä¸‹ï¼Œå­˜æ”¾åœ¨ <code>Cookie</code> ä¸­å¯èƒ½æœ‰è¢« <code>CSRF</code> æ”»å‡»çš„é£é™©ã€‚æ¡†æ¶æä¾›äº†ä¸€ä¸ªé…ç½®é¡¹ <code>useSession</code>ï¼Œå¯ä»¥å°† token å­˜æ”¾åˆ° Session ä¸­ã€‚</p><p>å½“ <code>CSRF token</code> å­˜å‚¨åœ¨ <code>Cookie</code> ä¸­æ—¶ï¼Œä¸€æ—¦åœ¨åŒä¸€ä¸ªæµè§ˆå™¨ä¸Šå‘ç”Ÿç”¨æˆ·åˆ‡æ¢ï¼Œæ–°ç™»é™†çš„ç”¨æˆ·å°†ä¼šä¾æ—§ä½¿ç”¨æ—§çš„ tokenï¼ˆä¹‹å‰ç”¨æˆ·ä½¿ç”¨çš„ï¼‰ï¼Œè¿™ä¼šå¸¦æ¥ä¸€å®šçš„å®‰å…¨é£é™©ï¼Œå› æ­¤åœ¨æ¯æ¬¡ç”¨æˆ·ç™»é™†çš„æ—¶å€™éƒ½å¿…é¡»è°ƒç”¨ <code>ctx.rotateCsrfSecret()</code> åˆ·æ–° <code>CSRF token</code>ï¼Œä¾‹å¦‚ï¼š</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">Controller</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">HomeController</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @</span><span class="token function maybe-class-name" style="color:#d73a49">Inject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ctx</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @</span><span class="token function maybe-class-name" style="color:#d73a49">Inject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  userService</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @</span><span class="token function maybe-class-name" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/login&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">login</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">Body</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> username</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> @</span><span class="token function maybe-class-name" style="color:#d73a49">Body</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> password</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> user </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> userService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">login</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> username</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> password </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">session</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> user </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">rotateCsrfSecret</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">success</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="äºŒxss">äºŒã€XSS<a class="hash-link" href="#äºŒxss" title="Direct link to heading">â€‹</a></h3><p><code>XSS</code>ï¼ˆcross-site scripting è·¨ç«™è„šæœ¬æ”»å‡»ï¼‰æ”»å‡»æ˜¯æœ€å¸¸è§çš„ Web æ”»å‡»ï¼Œæ˜¯ä»£ç æ³¨å…¥çš„ä¸€ç§ã€‚å®ƒå…è®¸æ¶æ„ç”¨æˆ·å°†ä»£ç æ³¨å…¥åˆ°ç½‘é¡µä¸Šï¼Œå…¶ä»–ç”¨æˆ·åœ¨è§‚çœ‹ç½‘é¡µæ—¶å°±ä¼šå—åˆ°å½±å“ã€‚</p><p><code>XSS</code> æ”»å‡»é€šå¸¸æŒ‡çš„æ˜¯é€šè¿‡åˆ©ç”¨ç½‘é¡µå¼€å‘æ—¶ç•™ä¸‹çš„æ¼æ´ï¼Œé€šè¿‡å·§å¦™çš„æ–¹æ³•æ³¨å…¥æ¶æ„æŒ‡ä»¤ä»£ç åˆ°ç½‘é¡µï¼Œä½¿ç”¨æˆ·åŠ è½½å¹¶æ‰§è¡Œæ”»å‡»è€…æ¶æ„åˆ¶é€ çš„ç½‘é¡µç¨‹åºã€‚æ”»å‡»æˆåŠŸåï¼Œæ”»å‡»è€…å¯èƒ½å¾—åˆ°æ›´é«˜çš„æƒé™ï¼ˆå¦‚æ‰§è¡Œä¸€äº›æ“ä½œï¼‰ã€ç§å¯†ç½‘é¡µå†…å®¹ã€ä¼šè¯å’Œcookieç­‰å„ç§å†…å®¹ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="1-åå°„å‹çš„-xss-æ”»å‡»">1. åå°„å‹çš„ XSS æ”»å‡»<a class="hash-link" href="#1-åå°„å‹çš„-xss-æ”»å‡»" title="Direct link to heading">â€‹</a></h4><p>ä¸»è¦æ˜¯ç”±äºæœåŠ¡ç«¯æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„ä¸å®‰å…¨è¾“å…¥ï¼Œåœ¨å®¢æˆ·ç«¯è§¦å‘ä»£ç æ‰§è¡Œä»è€Œå‘èµ· <code>Web</code> æ”»å‡»ã€‚</p><p>ä¾‹å¦‚ï¼šåœ¨æŸæœç´¢ç½‘ç«™æœç´¢æ—¶ï¼Œæœç´¢ç»“æœä¼šæ˜¾ç¤ºæœç´¢çš„å…³é”®è¯ã€‚æœç´¢å…³é”®è¯å¡«å…¥ <code>&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;</code>, ç‚¹å‡»æœç´¢åï¼Œè‹¥é¡µé¢ç¨‹åºæ²¡æœ‰å¯¹å…³é”®è¯è¿›è¡Œå¤„ç†ï¼Œè¿™æ®µä»£ç å°±ä¼šç›´æ¥åœ¨é¡µé¢ä¸Šæ‰§è¡Œï¼Œå¼¹å‡º alertã€‚</p><p>æ¡†æ¶æä¾›äº† <code>ctx.security.escape()</code> æ–¹æ³•å¯¹å­—ç¬¦ä¸²è¿›è¡Œ XSS è¿‡æ»¤ã€‚</p><div class="codeBlockContainer_I0IT language-ts theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-ts codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Controller</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">HomeController</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Inject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ctx</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/home&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">home</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> escapedStr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">security</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">escape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// &amp;lt;script&amp;gt;alert(&amp;quot;xss&amp;quot;) &amp;lt;/script&amp;gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> escapedStr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>å¦å¤–å½“ç½‘ç«™è¾“å‡ºçš„å†…å®¹æ˜¯ä½œä¸º js è„šæœ¬çš„ã€‚è¿™ä¸ªæ—¶å€™éœ€è¦ä½¿ç”¨ <code>ctx.security.js()</code> æ¥è¿›è¡Œè¿‡æ»¤ã€‚</p><p>è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨ <code>js</code> ä¸­è¾“å‡º <code>json</code> ï¼Œè‹¥æœªåšè½¬ä¹‰ï¼Œæ˜“è¢«åˆ©ç”¨ä¸º <code>XSS</code> æ¼æ´ã€‚æ¡†æ¶æä¾›äº† <code>ctx.security.json(å˜é‡)</code> æ¥æä¾› json encodeï¼Œé˜²æ­¢ XSS æ”»å‡»ã€‚</p><div class="codeBlockContainer_I0IT language-ts theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-ts codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Controller</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">HomeController</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Inject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ctx</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/home&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">home</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">&lt;script&gt;windows.config = </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation keyword" style="color:#00009f">this</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation property-access">ctx</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation property-access">security</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation method function property-access" style="color:#d73a49">json</span><span class="token template-string interpolation punctuation" style="color:#393A34">(</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation spread operator" style="color:#393A34">...</span><span class="token template-string interpolation">variable </span><span class="token template-string interpolation punctuation" style="color:#393A34">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">;&lt;/script&gt;</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="2-å­˜å‚¨å‹çš„-xss-æ”»å‡»">2. å­˜å‚¨å‹çš„ XSS æ”»å‡»<a class="hash-link" href="#2-å­˜å‚¨å‹çš„-xss-æ”»å‡»" title="Direct link to heading">â€‹</a></h4><p>é€šè¿‡æäº¤å¸¦æœ‰æ¶æ„è„šæœ¬çš„å†…å®¹å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œå½“å…¶ä»–äººçœ‹åˆ°è¿™äº›å†…å®¹æ—¶å‘èµ· Web æ”»å‡»ï¼Œæ¯”å¦‚ä¸€äº›ç½‘ç«™çš„è¯„è®ºæ¡†ä¸­ï¼Œç”¨æˆ·æ¶æ„å°†ä¸€äº›ä»£ç ä½œä¸ºè¯„è®ºå†…å®¹ï¼Œè‹¥æ²¡æœ‰è¿‡æ»¤ï¼Œå…¶ä»–ç”¨æˆ·çœ‹åˆ°è¿™ä¸ªè¯„è®ºæ—¶æ¶æ„ä»£ç å°±ä¼šæ‰§è¡Œã€‚</p><p>æ¡†æ¶æä¾›äº† <code>ctx.security.html()</code> æ¥è¿›è¡Œè¿‡æ»¤ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="3-å…¶ä»–-xss-çš„é˜²èŒƒæ–¹å¼">3. å…¶ä»– XSS çš„é˜²èŒƒæ–¹å¼<a class="hash-link" href="#3-å…¶ä»–-xss-çš„é˜²èŒƒæ–¹å¼" title="Direct link to heading">â€‹</a></h4><p>æµè§ˆå™¨è‡ªèº«å…·æœ‰ä¸€å®šé’ˆå¯¹å„ç§æ”»å‡»çš„é˜²èŒƒèƒ½åŠ›ï¼Œä»–ä»¬ä¸€èˆ¬æ˜¯é€šè¿‡å¼€å¯ Web å®‰å…¨å¤´ç”Ÿæ•ˆçš„ã€‚æ¡†æ¶å†…ç½®äº†ä¸€äº›å¸¸è§çš„ Web å®‰å…¨å¤´çš„æ”¯æŒã€‚</p><p><strong>CSP</strong></p><p><code>Content Security Policy</code>ï¼Œç®€ç§° <code>CSP</code>ï¼Œä¸»è¦æ˜¯ç”¨æ¥å®šä¹‰é¡µé¢å¯ä»¥åŠ è½½å“ªäº›èµ„æºï¼Œå‡å°‘ <code>XSS</code> çš„å‘ç”Ÿã€‚</p><p>é»˜è®¤å…³é—­ï¼ˆå¯é€šè¿‡ <code>csp: {enable: true}</code> é…ç½®å¼€å¯ï¼‰ï¼Œå¼€å¯åå¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢ <code>XSS</code> æ”»å‡»çš„å‘ç”Ÿã€‚è¦é…ç½® <code>CSP</code> , éœ€è¦å¯¹ <code>CSP</code> çš„ <code>policy</code> ç­–ç•¥æœ‰äº†è§£ï¼Œå…·ä½“ç»†èŠ‚å¯ä»¥å‚è€ƒ <a href="https://www.zhihu.com/question/21979782/answer/122682029" target="_blank" rel="noopener noreferrer">é˜¿é‡Œèšå®‰å…¨ - CSPæ˜¯ä»€ä¹ˆï¼Ÿ</a></p><p><strong>X-Download-Options:noopen</strong></p><p>é»˜è®¤å¼€å¯ï¼ˆå¯é€šè¿‡ <code>noopen: {enable: false}</code> é…ç½®å…³é—­ï¼‰ï¼Œç¦ç”¨ IE ä¸‹ä¸‹è½½æ¡† Open æŒ‰é’®ï¼Œé˜²æ­¢ IE ä¸‹ä¸‹è½½æ–‡ä»¶é»˜è®¤è¢«æ‰“å¼€ XSSã€‚</p><p><strong>X-Content-Type-Options:nosniff</strong>
ç¦ç”¨ IE8 è‡ªåŠ¨å—…æ¢ mime åŠŸèƒ½ï¼Œé»˜è®¤å…³é—­ï¼ˆå¯é€šè¿‡ <code>nosniff: {enable: true}</code> é…ç½®å¼€å¯ï¼‰ï¼Œä¾‹å¦‚ text/plain å´å½“æˆ text/html æ¸²æŸ“ï¼Œç‰¹åˆ«å½“æœ¬ç«™ç‚¹ serve çš„å†…å®¹æœªå¿…å¯ä¿¡çš„æ—¶å€™ã€‚</p><p><strong>X-XSS-Protection</strong>
IE æä¾›çš„ä¸€äº› XSS æ£€æµ‹ä¸é˜²èŒƒï¼Œé»˜è®¤å¼€å¯ï¼ˆå¯é€šè¿‡ <code>xssProtection: {enable: false}</code> é…ç½®å…³é—­ï¼‰</p><p>close é»˜è®¤å€¼ falseï¼Œå³è®¾ç½®ä¸º 1; mode=block</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="é…ç½®">é…ç½®<a class="hash-link" href="#é…ç½®" title="Direct link to heading">â€‹</a></h2><p>é»˜è®¤é…ç½®å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_I0IT language-ts theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-ts codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// src/config/config.default</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// é»˜è®¤é…ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  security</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    csrf</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ctoken&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      useSession</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      cookieName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;csrfToken&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      sessionName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;csrfToken&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      headerName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;x-csrf-token&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      bodyName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;_csrf&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      queryName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;_csrf&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      refererWhiteList</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xframe</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SAMEORIGIN&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    csp</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hsts</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      maxAge</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      includeSubdomains</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    noopen</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nosniff</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xssProtection</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1; mode=block&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="csrf">csrf<a class="hash-link" href="#csrf" title="Direct link to heading">â€‹</a></h3><table><thead><tr><th>é…ç½®é¡¹</th><th>ç±»å‹</th><th>ä½œç”¨æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>enable</td><td>boolean</td><td>æ˜¯å¦å¼€å¯</td><td>true</td></tr><tr><td>type</td><td>&#x27;all&#x27; / &#x27;any&#x27; / &#x27;ctoken&#x27; / &#x27;referer&#x27;</td><td>csrf æ ¡éªŒç±»å‹ï¼Œall/any ç­‰äº ctoken + referer</td><td>&#x27;ctoken&#x27; ä»query/header/body ä¸­è·å– csrf token</td></tr><tr><td>useSession</td><td>boolean</td><td>csrf token æ˜¯å¦å­˜æ”¾åœ¨ session ä¸­</td><td>falseï¼Œé»˜è®¤å­˜æ”¾åœ¨ cookies ä¸­</td></tr><tr><td>cookieName</td><td>string</td><td>token åœ¨ cookie ä¸­å­˜æ”¾çš„ å­—æ®µ</td><td>&#x27;csrfToken&#x27;</td></tr><tr><td>sessionName</td><td>string</td><td>token åœ¨ session ä¸­å­˜æ”¾çš„ å­—æ®µ</td><td>&#x27;csrfToken&#x27;</td></tr><tr><td>headerName</td><td>string</td><td>token åœ¨ header ä¸­å­˜æ”¾çš„ å­—æ®µ</td><td>&#x27;x-csrf-token&#x27;</td></tr><tr><td>bodyName</td><td>string</td><td>token åœ¨ body ä¸­å­˜æ”¾çš„ å­—æ®µ</td><td>&#x27;_csrf&#x27;</td></tr><tr><td>queryName</td><td>string</td><td>token åœ¨ query ä¸­å­˜æ”¾çš„ å­—æ®µ</td><td>&#x27;_csrf&#x27;</td></tr><tr><td>refererWhiteList</td><td>Array&lt;string<!-- -->&gt;</td><td>å…è®¸çš„æ¥æºç™½åå•</td><td>[]</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="xframe">xframe<a class="hash-link" href="#xframe" title="Direct link to heading">â€‹</a></h3><p>xframe ç”¨æ¥é…ç½® <code>X-Frame-Options</code> å“åº”å¤´ï¼Œç”¨æ¥ç»™æµè§ˆå™¨æŒ‡ç¤ºå…è®¸ä¸€ä¸ªé¡µé¢å¯å¦åœ¨ <code>frame</code>, <code>iframe</code>, <code>embed</code> æˆ–è€… <code>object</code> ä¸­å±•ç°çš„æ ‡è®°ã€‚ç«™ç‚¹å¯ä»¥é€šè¿‡ç¡®ä¿ç½‘ç«™æ²¡æœ‰è¢«åµŒå…¥åˆ°åˆ«äººçš„ç«™ç‚¹é‡Œé¢ï¼Œä»è€Œé¿å… <code>clickjacking</code> æ”»å‡»ã€‚</p><p><code>X-Frame-Options</code> æœ‰ä¸‰ä¸ªå¯èƒ½çš„å€¼ï¼š</p><ul><li>X-Frame-Options: denyï¼šé¡µé¢ä¸å…è®¸åœ¨ frame ä¸­å±•ç¤º</li><li>X-Frame-Options: sameoriginï¼šè¯¥é¡µé¢å¯ä»¥åœ¨ç›¸åŒåŸŸåé¡µé¢çš„ frame ä¸­å±•ç¤º</li><li>X-Frame-Options: allow-from <a href="https://example.com/%EF%BC%9A%E8%AF%A5%E9%A1%B5%E9%9D%A2%E5%8F%AF%E4%BB%A5%E5%9C%A8%E6%8C%87%E5%AE%9A%E6%9D%A5%E6%BA%90%E7%9A%84" target="_blank" rel="noopener noreferrer">https://example.com/ï¼šè¯¥é¡µé¢å¯ä»¥åœ¨æŒ‡å®šæ¥æºçš„</a> frame ä¸­å±•ç¤º</li></ul><table><thead><tr><th>é…ç½®é¡¹</th><th>ç±»å‹</th><th>ä½œç”¨æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>enable</td><td>boolean</td><td>æ˜¯å¦å¼€å¯</td><td>true</td></tr><tr><td>value</td><td>string</td><td>X-Frame-Options å€¼</td><td>&#x27;SAMEORIGIN&#x27;</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="hsts">hsts<a class="hash-link" href="#hsts" title="Direct link to heading">â€‹</a></h3><p><code>HTTP Strict Transport Security</code>ï¼ˆé€šå¸¸ç®€ç§°ä¸º <code>HSTS</code> ï¼‰æ˜¯ä¸€ä¸ªå®‰å…¨åŠŸèƒ½ï¼Œå®ƒå‘Šè¯‰æµè§ˆå™¨åªèƒ½é€šè¿‡ <code>HTTPS</code> è®¿é—®å½“å‰èµ„æºï¼Œè€Œä¸æ˜¯ <code>HTTP</code>ã€‚</p><table><thead><tr><th>é…ç½®é¡¹</th><th>ç±»å‹</th><th>ä½œç”¨æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>enable</td><td>boolean</td><td>æ˜¯å¦å¼€å¯</td><td>false</td></tr><tr><td>maxAge</td><td>number</td><td>åœ¨æµè§ˆå™¨æ”¶åˆ°è¿™ä¸ªè¯·æ±‚åçš„å¤šå°‘ <code>ç§’</code> æ—¶é—´å†…å‡¡æ˜¯è®¿é—®è¿™ä¸ªåŸŸåä¸‹çš„è¯·æ±‚éƒ½ä½¿ç”¨HTTPSè¯·æ±‚</td><td><code>365 * 24 * 3600</code> å³ä¸€å¹´</td></tr><tr><td>includeSubdomains</td><td>boolean</td><td>æ­¤è§„åˆ™æ˜¯å¦é€‚ç”¨äºè¯¥ç½‘ç«™çš„æ‰€æœ‰å­åŸŸå</td><td>false</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="csp">csp<a class="hash-link" href="#csp" title="Direct link to heading">â€‹</a></h3><p>HTTP å“åº”å¤´ <code>Content-Security-Policy</code> å…è®¸ç«™ç‚¹ç®¡ç†è€…æ§åˆ¶æŒ‡å®šçš„é¡µé¢åŠ è½½å“ªäº›èµ„æºã€‚è¿™å°†å¸®åŠ©é˜²æ­¢è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚</p><table><thead><tr><th>é…ç½®é¡¹</th><th>ç±»å‹</th><th>ä½œç”¨æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>enable</td><td>boolean</td><td>æ˜¯å¦å¼€å¯</td><td>false</td></tr><tr><td>policy</td><td>Object&lt;key: string, value: string / string[] / boolean&gt;</td><td>ç­–ç•¥åˆ—è¡¨</td><td>{}</td></tr><tr><td>reportOnly</td><td>boolean</td><td>æ˜¯å¦å¼€å¯</td><td>false</td></tr><tr><td>supportIE</td><td>boolean</td><td>æ˜¯å¦æ”¯æŒIEæµè§ˆå™¨</td><td>false</td></tr></tbody></table><p>è¯¦ç»†çš„ <code>policy</code> é…ç½®å¯ä»¥å‚è€ƒ: <a href="https://www.zhihu.com/question/21979782/answer/122682029" target="_blank" rel="noopener noreferrer">Content Security Policy (CSP) æ˜¯ä»€ä¹ˆï¼Ÿé˜¿é‡Œèšå®‰å…¨</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="noopen">noopen<a class="hash-link" href="#noopen" title="Direct link to heading">â€‹</a></h3><p>ç”¨äºæŒ‡å®š <code>IE 8</code> ä»¥ä¸Šç‰ˆæœ¬çš„ç”¨æˆ·ä¸æ‰“å¼€æ–‡ä»¶è€Œç›´æ¥ä¿å­˜æ–‡ä»¶ã€‚åœ¨ä¸‹è½½å¯¹è¯æ¡†ä¸­ä¸æ˜¾å¼â€œæ‰“å¼€â€é€‰é¡¹ã€‚</p><table><thead><tr><th>é…ç½®é¡¹</th><th>ç±»å‹</th><th>ä½œç”¨æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>enable</td><td>boolean</td><td>æ˜¯å¦å¼€å¯</td><td>false</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="nosniff">nosniff<a class="hash-link" href="#nosniff" title="Direct link to heading">â€‹</a></h3><p>å¼€å¯åï¼Œå¦‚æœä» <code>script</code> æˆ– <code>stylesheet</code> è¯»å…¥çš„æ–‡ä»¶çš„ <code>MIME</code> ç±»å‹ä¸æŒ‡å®š <code>MIME</code> ç±»å‹ä¸åŒ¹é…ï¼Œä¸å…è®¸è¯»å–è¯¥æ–‡ä»¶ã€‚ç”¨äºé˜²æ­¢ <code>XSS</code> ç­‰è·¨ç«™è„šæœ¬æ”»å‡»ã€‚</p><table><thead><tr><th>é…ç½®é¡¹</th><th>ç±»å‹</th><th>ä½œç”¨æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>enable</td><td>boolean</td><td>æ˜¯å¦å¼€å¯</td><td>false</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="xssprotection">xssProtection<a class="hash-link" href="#xssprotection" title="Direct link to heading">â€‹</a></h3><p>ç”¨äºå¯ç”¨æµè§ˆå™¨çš„XSSè¿‡æ»¤åŠŸèƒ½ï¼Œä»¥é˜²æ­¢ <code>XSS</code> è·¨ç«™è„šæœ¬æ”»å‡»ã€‚</p><p><code>X-XSS-Protection</code> å“åº”å¤´æ˜¯ <code>IE</code>ï¼Œ<code>Chrome</code> å’Œ <code>Safari</code> çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå½“æ£€æµ‹åˆ°è·¨ç«™è„šæœ¬æ”»å‡» (XSS (en-US))æ—¶ï¼Œæµè§ˆå™¨å°†åœæ­¢åŠ è½½é¡µé¢ã€‚è‹¥ç½‘ç«™è®¾ç½®äº†è‰¯å¥½çš„ <code>Content-Security-Policy</code> æ¥ç¦ç”¨å†…è” JavaScript (&#x27;unsafe-inline&#x27;)ï¼Œç°ä»£æµè§ˆå™¨ä¸å¤ªéœ€è¦è¿™äº›ä¿æŠ¤ï¼Œ ä½†å…¶ä»ç„¶å¯ä»¥ä¸ºå°šä¸æ”¯æŒ <code>CSP</code> çš„æ—§ç‰ˆæµè§ˆå™¨çš„ç”¨æˆ·æä¾›ä¿æŠ¤ã€‚</p><p><code>X-XSS-Protection</code> å¯ä»¥é…ç½®ä¸‹è¿°å››ä¸ªå€¼</p><ul><li><code>0</code>: ç¦æ­¢XSSè¿‡æ»¤ã€‚</li><li><code>1</code>ï¼šå¯ç”¨XSSè¿‡æ»¤ï¼ˆé€šå¸¸æµè§ˆå™¨æ˜¯é»˜è®¤çš„ï¼‰ã€‚ å¦‚æœæ£€æµ‹åˆ°è·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæµè§ˆå™¨å°†æ¸…é™¤é¡µé¢ï¼ˆåˆ é™¤ä¸å®‰å…¨çš„éƒ¨åˆ†ï¼‰ã€‚</li><li><code>1;mode=block</code>ï¼šå¯ç”¨XSSè¿‡æ»¤ã€‚ å¦‚æœæ£€æµ‹åˆ°æ”»å‡»ï¼Œæµè§ˆå™¨å°†ä¸ä¼šæ¸…é™¤é¡µé¢ï¼Œè€Œæ˜¯é˜»æ­¢é¡µé¢åŠ è½½ã€‚</li><li><code>1; report=&lt;reporting-URI&gt;</code>ï¼š Chromium onlyï¼Œå¯ç”¨XSSè¿‡æ»¤ã€‚ å¦‚æœæ£€æµ‹åˆ°è·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæµè§ˆå™¨å°†æ¸…é™¤é¡µé¢å¹¶ä½¿ç”¨CSP report-uri (en-US)æŒ‡ä»¤çš„åŠŸèƒ½å‘é€è¿è§„æŠ¥å‘Šã€‚</li></ul><table><thead><tr><th>é…ç½®é¡¹</th><th>ç±»å‹</th><th>ä½œç”¨æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>enable</td><td>boolean</td><td>æ˜¯å¦å¼€å¯</td><td>false</td></tr><tr><td>value</td><td>string</td><td>X-XSS-Protection é…ç½®</td><td><code>1; mode=block</code></td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/midwayjs/midway/tree/main/site/docs/extensions/security.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/en/docs/extensions/express"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Express</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/en/docs/extensions/render"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">æ¨¡æ¿æ¸²æŸ“</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#å®‰è£…ä½¿ç”¨" class="table-of-contents__link toc-highlight">å®‰è£…ä½¿ç”¨</a></li><li><a href="#é˜²èŒƒå¸¸è§çš„å®‰å…¨å¨èƒ" class="table-of-contents__link toc-highlight">é˜²èŒƒå¸¸è§çš„å®‰å…¨å¨èƒ</a><ul><li><a href="#ä¸€csrf" class="table-of-contents__link toc-highlight">ä¸€ã€CSRF</a></li><li><a href="#äºŒxss" class="table-of-contents__link toc-highlight">äºŒã€XSS</a></li></ul></li><li><a href="#é…ç½®" class="table-of-contents__link toc-highlight">é…ç½®</a><ul><li><a href="#csrf" class="table-of-contents__link toc-highlight">csrf</a></li><li><a href="#xframe" class="table-of-contents__link toc-highlight">xframe</a></li><li><a href="#hsts" class="table-of-contents__link toc-highlight">hsts</a></li><li><a href="#csp" class="table-of-contents__link toc-highlight">csp</a></li><li><a href="#noopen" class="table-of-contents__link toc-highlight">noopen</a></li><li><a href="#nosniff" class="table-of-contents__link toc-highlight">nosniff</a></li><li><a href="#xssprotection" class="table-of-contents__link toc-highlight">xssProtection</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/en/assets/js/runtime~main.4af01d91.js"></script>
<script src="/en/assets/js/main.a34cf7fc.js"></script>
<script>document.write(unescape("%3Cspan style='display: none' id='cnzz_stat_icon_1279723477'%3E%3C/span%3E%3Cscript src='https://v1.cnzz.com/z_stat.php%3Fid%3D1279723477' type='text/javascript'%3E%3C/script%3E"))</script></body>
</html>