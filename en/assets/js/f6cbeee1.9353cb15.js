"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[12535],{74641:e=>{e.exports=JSON.parse('{"blogPosts":[{"id":"release/3.19.0","metadata":{"permalink":"/en/blog/release/3.19.0","source":"@site/blog/2024-10-15-release-3.19.md","title":"Release 3.19.0","description":"\u5347\u7ea7\u8bf7\u53c2\u8003 \u5982\u4f55\u66f4\u65b0 Midway \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002","date":"2024-10-15T00:00:00.000Z","formattedDate":"October 15, 2024","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":2.47,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.19.0","title":"Release 3.19.0","authors":["harry"],"tags":["release"]},"nextItem":{"title":"Release 3.18.0","permalink":"/en/blog/release/3.18.0"}},"content":"\u5347\u7ea7\u8bf7\u53c2\u8003 [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\u672c\u6b21 3.19 \u7248\u672c\uff0c\u4e3b\u8981\u5f15\u5165\u4e86 Kafka \u7ec4\u4ef6\u7684\u91cd\u6784\uff0c\u4ee5\u53ca\u4e00\u4e9b\u6027\u80fd\u4f18\u5316\u548c bug \u4fee\u590d\u3002\\n\\n\u4e0b\u9762\u662f\u66f4\u4e3a\u7ec6\u8282\u7684\u63cf\u8ff0\u3002\\n\\n## Kafka \u7ec4\u4ef6\u91cd\u6784\\n\\n\u4ece v3.19 \u5f00\u59cb\uff0cKafka \u7ec4\u4ef6\u8fdb\u884c\u4e86\u91cd\u6784\uff0c\u914d\u7f6e\u548c\u4f7f\u7528\u65b9\u6cd5\u4e0e\u4e4b\u524d\u6709\u8f83\u5927\u5dee\u5f02\u3002\u867d\u7136\u539f\u6709\u7684\u4f7f\u7528\u65b9\u5f0f\u4ecd\u7136\u517c\u5bb9\uff0c\u4f46\u6587\u6863\u4e0d\u518d\u4fdd\u7559\u3002\u65b0\u7684 Kafka \u7ec4\u4ef6\u63d0\u4f9b\u4e86\u66f4\u7075\u6d3b\u7684\u914d\u7f6e\u548c\u66f4\u5f3a\u5927\u7684\u529f\u80fd\u3002\\n\\n```typescript\\n// src/config/config.default.ts\\nexport default {\\n  kafka: {\\n    consumer: {\\n      sub1: {\\n        connectionOptions: {\\n          clientId: \'my-app\',\\n          brokers: [\'localhost:9092\'],\\n        },\\n        consumerOptions: {\\n          groupId: \'groupId-test-1\',\\n        },\\n        subscribeOptions: {\\n          topics: [\'topic-test-1\'],\\n        }\\n      },\\n    },\\n    producer: {\\n      clients: {\\n        pub1: {\\n          connectionOptions: {\\n            clientId: \'my-app\',\\n            brokers: [\'localhost:9092\'],\\n          },\\n          producerOptions: {\\n            // ...\\n          }\\n        }\\n      }\\n    }\\n  }\\n}\\n```\\n\\n\u66f4\u591a\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u8003 [Kafka \u7ec4\u4ef6\u6587\u6863](/docs/extensions/kafka)\u3002\\n\\n## Mock \u529f\u80fd\u5206\u7ec4\\n\\n\u4ece `3.19.0` \u5f00\u59cb\uff0cMidway \u7684 mock \u529f\u80fd\u652f\u6301\u901a\u8fc7\u5206\u7ec4\u6765\u7ba1\u7406\u4e0d\u540c\u7684 mock \u6570\u636e\u3002\u4f60\u53ef\u4ee5\u5728\u521b\u5efa mock \u65f6\u6307\u5b9a\u4e00\u4e2a\u5206\u7ec4\u540d\u79f0\uff0c\u8fd9\u6837\u53ef\u4ee5\u5728\u9700\u8981\u65f6\u5355\u72ec\u6062\u590d\u6216\u6e05\u7406\u67d0\u4e2a\u5206\u7ec4\u7684 mock \u6570\u636e\u3002\\n\\n```typescript\\nimport { mockContext, restoreMocks } from \'@midwayjs/mock\';\\n\\nit(\'should test mock with groups\', async () => {\\n  const app = await createApp();\\n\\n  // \u521b\u5efa\u666e\u901a\u5bf9\u8c61\u7684 mock\\n  const a = {};\\n  mockProperty(a, \'getUser\', async () => {\\n    return \'midway\';\\n  }, \'group1\');\\n\\n  // \u521b\u5efa\u4e0a\u4e0b\u6587\u7684 mock\\n  mockContext(app, \'user\', \'midway\', \'group1\');\\n  mockContext(app, \'role\', \'admin\', \'group2\');\\n\\n  // \u6062\u590d\u5355\u4e2a\u5206\u7ec4\\n  restoreMocks(\'group1\');\\n\\n  // \u6062\u590d\u6240\u6709\u5206\u7ec4\\n  restoreAllMocks();\\n});\\n```\\n\\n\u901a\u8fc7\u5206\u7ec4\uff0c\u4f60\u53ef\u4ee5\u66f4\u7075\u6d3b\u5730\u7ba1\u7406\u548c\u63a7\u5236 mock \u6570\u636e\uff0c\u7279\u522b\u662f\u5728\u590d\u6742\u7684\u6d4b\u8bd5\u573a\u666f\u4e2d\u3002\\n\\n## \u65b0\u589e\u4e86\u4e00\u4e2a\u542f\u52a8\u6027\u80fd\u5206\u6790\u7684\u547d\u4ee4\\n\\n\u5728\u5f00\u53d1\u73af\u5883\u4e0b\uff0c\u65b0\u589e\u4e86\u4e00\u4e2a `perf-init` \u547d\u4ee4\uff0c\u7528\u4e8e\u5728\u542f\u52a8\u65f6\u521d\u59cb\u5316\u6027\u80fd\u5206\u6790\uff0c\u9700\u8981\u914d\u5408\u6700\u65b0\u7684 `mwtsc` \u4e00\u540c\u4f7f\u7528\u3002\\n\\n```json\\n{\\n  \\"scripts\\": {\\n    \\"dev\\": \\"cross-env NODE_ENV=local mwtsc --watch --run @midwayjs/mock/app.js --perf-init\\"\\n  }\\n}\\n```\\n\\n\\n## \u5176\u4ed6\u66f4\u65b0\\n\\n* \u66f4\u65b0\u4e86\u4e00\u4e9b\u4f9d\u8d56\u5e93\u4ee5\u63d0\u9ad8\u5b89\u5168\u6027\u548c\u7a33\u5b9a\u6027\u3002\\n\\n\u66f4\u591a\u7684\u66f4\u65b0\u5185\u5bb9\u548c\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u8003\u6211\u4eec\u7684 [ChangeLog](https://midwayjs.org/changelog/v3.19.0)\u3002"},{"id":"release/3.18.0","metadata":{"permalink":"/en/blog/release/3.18.0","source":"@site/blog/2024-09-22-release-3.18.md","title":"Release 3.18.0","description":"\u5347\u7ea7\u8bf7\u53c2\u8003  \u5982\u4f55\u66f4\u65b0 Midway \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002","date":"2024-09-22T00:00:00.000Z","formattedDate":"September 22, 2024","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":1.83,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.18.0","title":"Release 3.18.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"Release 3.19.0","permalink":"/en/blog/release/3.19.0"},"nextItem":{"title":"Release 3.17.0","permalink":"/en/blog/release/3.17.0"}},"content":"\u5347\u7ea7\u8bf7\u53c2\u8003  [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\u672c\u6b21 3.18 \u7248\u672c\uff0c\u4e3b\u8981\u4fee\u590d\u4e86\u65b0\u7684 busboy \u7ec4\u4ef6\u7684\u4e00\u4e9b\u9057\u7559\u95ee\u9898\uff0c\u4ee5\u53ca\u65b0\u589e\u4e86\u4e00\u79cd\u4e0a\u4f20\u6a21\u5f0f\u3002\\n\\n\u4e0b\u9762\u662f\u66f4\u4e3a\u7ec6\u8282\u7684\u63cf\u8ff0\u3002\\n\\n\\n## \u5f02\u6b65\u8fed\u4ee3\u5668\u4e0a\u4f20\u6a21\u5f0f\\n\\n\u4e3a\u4e86\u652f\u6301\u5355\u6b21\u591a\u4e2a\u6587\u4ef6\u7684\u6d41\u5f0f\u4e0a\u4f20\uff0c\u65b0\u7248\u672c\u4f7f\u7528\u4e86\u5f02\u6b65\u8fed\u4ee3\u5668\u6a21\u578b\u8f6c\u6362\u4e86\u4e0a\u4f20\u6d41\uff0c\u8fd9\u4e2a\u65b0\u7684\u6a21\u5f0f\u7528\u4e8e\u66ff\u4ee3\u539f\u6709\u7684\u6d41\u5f0f\u6a21\u5f0f\u3002\\n\\n```typescript\\n// src/config/config.default.ts\\nexport default {\\n  // ...\\n  busboy: {\\n    mode: \'asyncIterator\',\\n  },\\n}\\n```\\n\\n\u88c5\u9970\u5668\u7684\u5165\u53c2\u4e5f\u5df2\u7ecf\u53d8\u6210\u4e86\u5f02\u6b65\u8fed\u4ee3\u5668\u3002\\n\\n```typescript\\nimport { Controller, Post, Files, Fields } from \'@midwayjs/core\';\\nimport { UploadStreamFileInfo, UploadStreamFieldInfo } from \'@midwayjs/busboy\';\\n\\n@Controller(\'/\')\\nexport class HomeController {\\n\\n  @Post(\'/upload\', /*...*/)\\n  async upload(\\n    @Files() fileIterator: AsyncGenerator<UploadStreamFileInfo>,\\n    @Fields() fieldIterator: AsyncGenerator<UploadStreamFieldInfo>\\n  ) {\\n    // ...\\n  }\\n}\\n```\\n\\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5faa\u73af\u8fed\u4ee3\u5668\u83b7\u53d6\u5230\u6bcf\u4e2a\u4e0a\u4f20\u7684\u6587\u4ef6\u3002\\n\\n```typescript\\nfor await (const file of fileIterator) {\\n  const { filename, data } = file;\\n  // ...\\n}\\n```\\n\\n\u8fdb\u800c\u53ef\u4ee5\u65b9\u4fbf\u7684\u505a\u540e\u7eed\u5904\u7406\u3002\\n\\n\u66f4\u591a\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u8003 [\u7ec6\u8282\u6587\u6863](/docs/extensions/busboy)\u3002\\n\\n\\n\\n## \u6b64\u5916\u8fd8\u6709\u66f4\u591a\u7684\u53d8\u5316\\n\\n* \u6d41\u5f0f\u4e0a\u4f20\u65f6\u7684 `fieldName` \u5b57\u6bb5\u73b0\u5728\u6062\u590d\u4e86\\n* httpClient \u73b0\u5728\u9ed8\u8ba4\u7684\u914d\u7f6e\u4e0d\u518d\u4f1a\u88ab\u5355\u6b21\u8bf7\u6c42\u8986\u76d6\\n* \u6570\u636e\u6e90\u7684\u4f18\u5148\u7ea7 NPE \u62a5\u9519\u73b0\u5728\u5df2\u7ecf\u4fee\u590d\u4e86\\n* \u4e1a\u52a1\u4e2d\u7684 https \u914d\u7f6e\u73b0\u5728\u5728 dev \u7684\u8f93\u51fa\u63d0\u793a\u4e2d\u4e5f\u53d8\u5f97\u6b63\u5e38\u4e86\\n\\n\u4ee5\u53ca\u4e00\u5927\u6279\u4f9d\u8d56\u8fdb\u884c\u4e86\u66f4\u65b0\uff0c\u53ef\u4ee5\u53c2\u8003\u6211\u4eec\u7684 [ChangeLog](https://midwayjs.org/changelog/v3.18.0)\u3002"},{"id":"release/3.17.0","metadata":{"permalink":"/en/blog/release/3.17.0","source":"@site/blog/2024-08-29-release-3.17.md","title":"Release 3.17.0","description":"\u5347\u7ea7\u8bf7\u53c2\u8003  \u5982\u4f55\u66f4\u65b0 Midway \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002","date":"2024-08-29T00:00:00.000Z","formattedDate":"August 29, 2024","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":4.295,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.17.0","title":"Release 3.17.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"Release 3.18.0","permalink":"/en/blog/release/3.18.0"},"nextItem":{"title":"mwtsc \u589e\u52a0\u7248\u672c\u68c0\u67e5","permalink":"/en/blog/mwtsc-check"}},"content":"\u5347\u7ea7\u8bf7\u53c2\u8003  [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\u672c\u6b21 3.17 \u7248\u672c\uff0c\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e9b\u65b0\u7684\u7279\u6027\uff0c\u4ee5\u53ca\u4fee\u590d\u4e86\u4e00\u4e9b\u95ee\u9898\uff0c\u4e3b\u8981\u6709\uff1a\\n\\n* 1\u3001\u4f7f\u7528  \u66ff\u6362\u539f\u6709\u7684\u4e0a\u4f20\u7ec4\u4ef6\\n* 2\u3001`busboy` \u4e0a\u4f20\u7684\u6570\u636e\u4e2d\u7684 `filedName`\uff0c\u5728\u6d41\u5f0f\u6a21\u5f0f\u4e0b\u4e0d\u518d\u63d0\u4f9b\\n* 3\u3001\u589e\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684\u670d\u52a1\u7aef\u54cd\u5e94\u683c\u5f0f\\n* 4\u3001class \u4e2d\u95f4\u4ef6\u73b0\u5728\u53ef\u4ee5\u590d\u7528\u4e86\\n\\n\u4e0b\u9762\u662f\u66f4\u4e3a\u7ec6\u8282\u7684\u63cf\u8ff0\u3002\\n\\n\\n## \u5b9a\u5236\u670d\u52a1\u7aef\u54cd\u5e94\u683c\u5f0f\\n\\n\u5728 3.17 \u7248\u672c\u4e2d\uff0c\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684\u7279\u6027\uff0c\u53ef\u4ee5\u5b9a\u5236\u670d\u52a1\u7aef\u7684\u54cd\u5e94\u7684\u901a\u7528\u683c\u5f0f\u3002\\n\\n\u5728\u4e4b\u524d\u7684\u7248\u672c\u4e2d\uff0c\u6211\u4eec\u4f9d\u9760\u4e2d\u95f4\u4ef6\u548c\u8fc7\u6ee4\u5668\u6765\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\uff0c\u4f46\u662f\u8fd9\u79cd\u65b9\u5f0f\u6709\u4e00\u4e9b\u5c40\u9650\u6027\uff0c\u4ee3\u7801\u4e5f\u4f1a\u5206\u6563\u5728\u4e0d\u540c\u7684\u5730\u65b9\u3002\\n\\n\u5982\u679c\u7531\u4e00\u4e2a\u7edf\u4e00\u7684\u53ef\u8c03\u6574\u7684\u8fd4\u56de\u903b\u8f91\uff0c\u53ef\u80fd\u66f4\u4e3a\u5408\u7406\uff0c\u4e3a\u6b64\uff0c\u6dfb\u52a0\u4e86 `ServerResponse` \u548c `HttpServerResponse` \u7684\u5b9e\u73b0\u3002\\n\\n```typescript\\nimport { ServerResponse, HttpServerResponse } from \'@midwayjs/core\';\\n\\n@Controller()\\nexport class HomeController {\\n  @Inject()\\n  ctx: Context;\\n\\n  @Get(\'/\')\\n  async index() {\\n    return new HttpServerResponse(this.ctx).json({\\n      success: true,\\n      data: \'hello world\',\\n    });\\n  }\\n}\\n```\\n\\n`HttpServerResponse` \u662f `ServerResponse` \u7684\u4e00\u4e2a Http \u5b9e\u73b0\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u65b9\u6cd5\u3002\\n\\n\u6700\u4e3a\u7279\u6b8a\u7684\u662f\u4ed6\u53ef\u4ee5\u9488\u5bf9\u4e0d\u540c\u7684\u6570\u636e\u683c\u5f0f\uff0c\u8bbe\u7f6e\u6210\u529f\u548c\u5931\u8d25\u7684\u6a21\u7248\u3002\\n\\n\u6bd4\u5982\u9488\u5bf9 JSON \u6570\u636e\uff0c\u6846\u67b6\u63d0\u4f9b\u4e86\u4ee5\u4e0b\u7684\u9ed8\u8ba4\u7ed3\u6784\u3002\\n\\n```typescript\\nHttpServerResponse.JSON_TPL = (data, isSuccess) => {\\n  if (isSuccess) {\\n    return {\\n      success: \'true\',\\n      data,\\n    };\\n  } else {\\n    return {\\n      success: \'false\',\\n      message: data || \'fail\',\\n    };\\n  }\\n};\\n```\\n\\n\u8fd9\u6837\uff0c\u5f53\u8fd4\u56de JSON \u683c\u5f0f\u65f6\uff0c\u5c31\u4f1a\u6309\u7167\u8fd9\u4e2a\u6a21\u7248\u8fdb\u884c\u8fd4\u56de\u3002\\n\\n```typescript\\n// \u5931\u8d25\u7684\u8fd4\u56de\\nreturn new HttpServerResponse(this.ctx).fail().json(\'hello world\');\\n```\\n\\n\u5c31\u4f1a\u83b7\u53d6\u5230\u4ee5\u4e0b\u7684\u6570\u636e\u3002\\n\\n```typescript\\n{\\n  success: \'false\',\\n  message: \'hello world\',\\n}\\n```\\n\\n\u6b64\u5916\uff0c\u57fa\u4e8e\u8fd9\u4e2a\u6a21\u5f0f\uff0c\u4e5f\u540c\u65f6\u5b9e\u73b0\u4e86 SSE \u7684\u54cd\u5e94\u8fd4\u56de\uff0c\u4e5f\u6709\u5176\u4ed6\u7684\u4e00\u4e9b\u6570\u636e\u7ed3\u6784\u7684\u8fd4\u56de\uff0c\u66f4\u591a\u7684\u5185\u5bb9\uff0c\u8bf7\u53c2\u8003 [\u7ec6\u8282\u6587\u6863](/docs/data_response)\u3002\\n\\n\\n\\n\\n## \u4e0a\u4f20\u7ec4\u4ef6\\n\\n\u7531\u4e8e\u5728\u5c0f\u6587\u4ef6\u573a\u666f\u4e0b\u4e0a\u4f20\u78b0\u5230\u4e00\u4e9b\u95ee\u9898\uff0c\u4ece v3.17 \u5f00\u59cb\uff0c\u57fa\u4e8e [busboy](https://github.com/mscdex/busboy) \u5b9e\u73b0\u4e86\u4e00\u4e2a\u65b0\u7684\u4e0a\u4f20\u7ec4\u4ef6\uff0c\u66ff\u6362\u539f\u6709\u7684 `@midwayjs/upload`\u3002\\n\\n\u548c\u539f\u6709\u7684\u7ec4\u4ef6\u6bd4\u6709\u4e00\u4e9b\u4e0d\u540c\u3002\\n\\n* 1\u3001\u4e0d\u518d\u9ed8\u8ba4\u52a0\u8f7d\u4e2d\u95f4\u4ef6\uff0c\u56e0\u4e3a\u4e0a\u4f20\u53ea\u662f\u5c11\u90e8\u5206\u63a5\u53e3\u7684\u7279\u6b8a\u903b\u8f91\uff0c\u4e0d\u9700\u8981\u5168\u5c40\u52a0\u8f7d\\n* 2\u3001\u914d\u7f6e\u7684 key \u4e3a\u4e86\u907f\u514d\u51b2\u7a81\uff0c\u4ece `upload` \u53d8\u4e3a `busboy`\\n\\n\u5176\u4f59\u7684\u4f7f\u7528\u65b9\u5f0f\u548c\u539f\u6709\u7684\u4e0a\u4f20\u7ec4\u4ef6\u4e00\u81f4\uff0c\\n\\n\u66f4\u591a\u7ec6\u8282\u8bf7\u8bbf\u95ee [\u6587\u6863](/docs/extensions/busboy)\u3002\\n\\n\\n\\n## \u7c7b\u4e2d\u95f4\u4ef6\u590d\u7528\\n\\n\u5728\u4e4b\u524d\uff0c\u5982\u679c\u9700\u8981\u590d\u7528\u4e2d\u95f4\u4ef6\uff0c\u53ea\u80fd\u4f7f\u7528\u51fd\u6570\u4e2d\u95f4\u4ef6\u3002\\n\\n```typescript\\nconst mw = (ctx, next) => {\\n  // ...\\n}\\n\\n@Controller(/**/)\\nexport class HomeController {\\n\\n  @Get(\'/\', { middleware: [mw]})\\n  async home() {}\\n  \\n  @Get(\'/api\', { middleware: [mw]})\\n  async api() {}\\n}\\n```\\n\\n\u4f46\u662f\u5982\u679c\u5e0c\u671b\u7528\u4e0a\u7ee7\u627f\uff0c\u6216\u8005 `match` \u548c `ignore` \u529f\u80fd\u7684\uff0c\u5219\u662f\u7c7b\u7684\u884c\u4e3a\u66f4\u4e3a\u65b9\u4fbf\u3002\\n\\n\u8fd9\u4e2a\u7248\u672c\u6846\u67b6\u63d0\u4f9b\u4e86 `createMiddleware` \u529f\u80fd\uff0c\u4fdd\u7559\u539f\u6709\u7684\u903b\u8f91\u540c\u65f6\uff0c\u53ef\u4ee5\u521b\u5efa\u51fa\u4e00\u4e2a\u65b0\u7684\u4e2d\u95f4\u4ef6\u5b9e\u4f8b\u3002\\n\\n```typescript\\n\\n@Middleware()\\nexport class ReportMiddleware implements IMiddleware<Context, NextFunction> {\\n  // ...\\n}\\n\\n@Controller(/**/)\\nexport class HomeController {\\n\\n  @Get(\'/\', { middleware: [createMiddleware(ReportMiddleware, {}, \'name1\')]})\\n  async home() {}\\n  \\n  @Get(\'/api\', { middleware: [createMiddleware(ReportMiddleware, {}, \'name2\')]})\\n  async api() {}\\n}\\n```\\n\\n\u901a\u8fc7\u5411 `createMiddleware` \u4f20\u9012\u4e0d\u540c\u7684\u53c2\u6570\uff0c\u4ee5\u53ca\u4e2d\u95f4\u4ef6\u540d\u5b57\uff0c\u5c31\u53ef\u4ee5\u5f15\u7528\u5230\u4e0d\u540c\u7684\u903b\u8f91\u3002\\n\\n\u66f4\u591a\u7684\u7ec6\u8282\uff0c\u8bf7\u67e5\u770b [Web\u4e2d\u95f4\u4ef6](/docs/middleware) \u6587\u6863\u3002\\n\\n\\n\\n\\n\\n## \u66f4\u591a\u7684\u53d8\u5316\\n\\n* \u4fee\u590d\u4e86\u4e00\u4e2a\u591a\u8bed\u8a00\u5339\u914d key \u7684\u95ee\u9898\\n* \u4e00\u4e9b\u4e0d\u5408\u7406\u7c7b\u578b\u5b9a\u4e49\u7684\u8c03\u6574\\n\\n\u4ee5\u53ca\u4e00\u5927\u6279\u4f9d\u8d56\u8fdb\u884c\u4e86\u66f4\u65b0\uff0c\u53ef\u4ee5\u53c2\u8003\u6211\u4eec\u7684 [ChangeLog](https://midwayjs.org/changelog/v3.17.0)\u3002"},{"id":"mwtsc-check","metadata":{"permalink":"/en/blog/mwtsc-check","source":"@site/blog/2024-07-12-mwtsc-check.md","title":"mwtsc \u589e\u52a0\u7248\u672c\u68c0\u67e5","description":"\u7531\u4e8e Midway \u7248\u672c\u53d1\u5e03\u89c4\u5219\uff0c@midwayjs/core \u548c\u7ec4\u4ef6\u6709\u7740\u7248\u672c\u5bf9\u5e94\u5173\u7cfb\uff0c\u5373\u4f4e\u7248\u672c\u7684 @midwayjs/core \u65e0\u6cd5\u4f7f\u7528\u9ad8\u7248\u672c\u7684\u7ec4\u4ef6\u3002","date":"2024-07-12T00:00:00.000Z","formattedDate":"July 12, 2024","tags":[{"label":"mwtsc","permalink":"/en/blog/tags/mwtsc"}],"readingTime":1.705,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"mwtsc-check","title":"mwtsc \u589e\u52a0\u7248\u672c\u68c0\u67e5","authors":["harry"],"tags":["mwtsc"]},"prevItem":{"title":"Release 3.17.0","permalink":"/en/blog/release/3.17.0"},"nextItem":{"title":"Release 3.16.0","permalink":"/en/blog/release/3.16.0"}},"content":"\u7531\u4e8e Midway \u7248\u672c\u53d1\u5e03\u89c4\u5219\uff0c`@midwayjs/core` \u548c\u7ec4\u4ef6\u6709\u7740\u7248\u672c\u5bf9\u5e94\u5173\u7cfb\uff0c\u5373\u4f4e\u7248\u672c\u7684 `@midwayjs/core` \u65e0\u6cd5\u4f7f\u7528\u9ad8\u7248\u672c\u7684\u7ec4\u4ef6\u3002\\n\\n\u6bd4\u5982 `@midwayjs/axios@3.17.0` \u53ef\u80fd\u4f7f\u7528\u4e86\u9ad8\u7248\u672c\u7684 API\uff0c\u662f\u65e0\u6cd5\u5728 `@midwayjs/core@3.16.0` \u7248\u672c\u4e0a\u6267\u884c\u7684\u3002\\n\\n\u7531\u4e8e npm \u7b49\u5305\u7ba1\u7406\u7684\u7279\u6027\uff0c\u5305\u5b89\u88c5\u65f6\u4e0d\u5b58\u5728\u8054\u7cfb\uff0c`npm i @midwayjs/axios` \u65f6\u5f80\u5f80\u53ea\u4f1a\u5b89\u88c5\u7ec4\u4ef6\u6700\u65b0\u7684\u7248\u672c\uff0c\u975e\u5e38\u5bb9\u6613\u9020\u6210\u517c\u5bb9\u6027\u95ee\u9898\u3002\\n\\n\u4e3a\u6b64\u6211\u4eec\u63d0\u4f9b\u4e86 `npx midway-version` \u547d\u4ee4\uff0c\u53ef\u4ee5\u5feb\u901f\u68c0\u67e5\u7248\u672c\u4e4b\u95f4\u7684\u517c\u5bb9\u6027\u9519\u8bef\u3002\\n\\n\u5728\u63a8\u884c\u4e00\u9635\u5b50\u4e4b\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u5f88\u5c11\u6709\u7528\u6237\u4e3b\u52a8\u53bb\u6267\u884c\u8fd9\u6837\u7684\u6307\u4ee4\uff0c\u53ea\u4f1a\u5728\u51fa\u9519\u65f6\u88ab\u52a8\u6267\u884c\uff0c\u518d\u52a0\u4e0a\u9501\u5305\u548c\u4e0d\u9501\u5305\u7684\u590d\u6742\u573a\u666f\uff0c\u4f1a\u51fa\u73b0\u4e00\u4e9b\u5f88\u96be\u590d\u73b0\u548c\u6392\u67e5\u7684\u73b0\u8c61\u3002\\n\\n\u4e3a\u4e86\u964d\u4f4e\u590d\u6742\u6027\uff0c\u5728 mwtsc \u65b0\u7248\u672c\u7684\u542f\u52a8\u9636\u6bb5\uff0c\u6211\u4eec\u4e5f\u52a0\u5165\u4e86\u68c0\u67e5\u4ee3\u7801\u3002\\n\\n![](https://img.alicdn.com/imgextra/i3/O1CN01ZHQcs51tDb5HrSviC_!!6000000005868-2-tps-1550-420.png)\\n\\n\u5982\u679c\u51fa\u73b0\u4e0d\u517c\u5bb9\u7684\u7248\u672c\uff0c\u5de5\u5177\u4f1a\u8fdb\u884c\u63d0\u793a\u3002\\n\\n\u6b64\u5916\uff0c\u65b0\u589e\u7684 `npx midway-version -m` \u6307\u4ee4\u53ef\u4ee5\u8ba9\u56fa\u5316\u7248\u672c\u7684\u7528\u6237\u4e5f\u4eab\u53d7\u5230\u66f4\u65b0\u5de5\u5177\u3002\\n\\n\u548c\u4e4b\u524d\u7684 `-u` \u6307\u4ee4\u4e0d\u540c\uff0c`-m` \u4f1a\u4f7f\u7528\u5f53\u524d\u7684 `@midwayjs/core` \u7248\u672c\uff0c\u66f4\u65b0\u7ec4\u4ef6\u5230\u6700\u517c\u5bb9\u7684\u7248\u672c\uff0c\u800c\u4e0d\u662f\u6700\u65b0\u7248\u672c\u3002\\n\\n\u7ed3\u5408 `mwtsc` \u548c `midway-version` \u5de5\u5177\uff0c\u53ef\u4ee5\u66f4\u7b80\u5355\u7684\u7ba1\u7406\u7248\u672c\uff0c\u5982\u6709\u95ee\u9898\u53ef\u4ee5\u53cd\u9988\u7ed9\u6211\u4eec\u6539\u8fdb\u3002"},{"id":"release/3.16.0","metadata":{"permalink":"/en/blog/release/3.16.0","source":"@site/blog/2024-05-07-release-3.16.md","title":"Release 3.16.0","description":"\u5347\u7ea7\u8bf7\u53c2\u8003  \u5982\u4f55\u66f4\u65b0 Midway \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002","date":"2024-05-07T00:00:00.000Z","formattedDate":"May 7, 2024","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":1.93,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.16.0","title":"Release 3.16.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"mwtsc \u589e\u52a0\u7248\u672c\u68c0\u67e5","permalink":"/en/blog/mwtsc-check"},"nextItem":{"title":"Release 3.15.0","permalink":"/en/blog/release/3.15.0"}},"content":"\u5347\u7ea7\u8bf7\u53c2\u8003  [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\u672c\u6b21 3.16 \u7248\u672c\uff0c\u91cd\u6784\u4e86 Swagger \u7ec4\u4ef6\uff0c\u65b0\u589e\u4e86\u4e00\u4e2a\u79df\u6237\u7ec4\u4ef6\u3002\\n\\n\\n\\n## Tenant\\n\\n\u65b0\u589e\u7ec4\u4ef6\uff0c\u63d0\u4f9b `TenantManager` \u8de8\u4f5c\u7528\u57df\u7ba1\u7406\u79df\u6237\u4fe1\u606f\u3002\\n\\n\u6bd4\u5982\uff1a\\n\\n```typescript\\nimport { TenantManager } from \'@midwayjs/tenant\';\\nimport { Middleware, Inject, Singleton } from \'@midwayjs/core\';\\n\\n// \u8bf7\u6c42\u94fe\u8def\u4e2d\u8bbe\u7f6e\uff0c\u4e2d\u95f4\u4ef6\u6216\u8005 Controller\\n@Middleware()\\nclass TenantMiddleware {\\n  @Inject()\\n  tenantManager: tenant.TenantManager;\\n\\n  resolve() {\\n    return async(ctx, next) => {\\n      this.tenantManager.setCurrentTenant({\\n        id: \'123\',\\n        name: \'\u6211\u7684\u79df\u6237\'\\n      });\\n    }\\n  }\\n}\\n\\n// \u670d\u52a1\u4e2d\\n@Singleton()\\nclass TenantService {\\n  @Inject()\\n  tenantManager: tenant.TenantManager;\\n\\n  async getTenantInfo() {\\n    const tenantInfo = await this.tenantManager.getCurrentTenant();\\n    console.log(tenantInfo.name);\\n    // \u6211\u7684\u79df\u6237\\n  }\\n}\\n```\\n\\n\\n\\n## MQTT\\n\\n\u589e\u52a0\u4e00\u4e2a\u52a8\u6001\u6dfb\u52a0 mqtt \u7684\u65b9\u6cd5\u3002\\n\\n```typescript\\nimport { Configuration, Inject } from \'@midwayjs/core\';\\nimport * as mqtt from \'@midwayjs/mqtt\';\\n\\n@Configuration({\\n  // ...\\n})\\nclass MainConfiguration {\\n  \\n  @Inject()\\n  mqttFramework: mqtt.Framework;\\n  \\n  async onReady() {\\n    await this.mqttFramework.createSubscriber({\\n      host: \'test.mosquitto.org\',\\n      port: 1883,\\n    }, {\\n      topicObject: \'test_midway_dynamic\',\\n    }, TestSubscriber, \'test\');\\n  }\\n}\\n```\\n\\n\\n\\n\\n\\n## Swagger\\n\\n\u4ee3\u7801\u91cd\u6784\uff0c\u652f\u6301\u4e86 oneof \u7b49\u7279\u6b8a\u7528\u6cd5\uff0c\u589e\u52a0\u51e0\u5341\u4e2a\u7528\u4f8b\u786e\u4fdd\u8f93\u51fa\u548c openapi 3.0 \u4e00\u81f4\u3002\\n\\n\u6bd4\u5982\uff1a\\n\\n```typescript\\nimport { ApiProperty } from \'@midwayjs/swagger\';  \\n\\nclass Album {\\n  @ApiProperty()\\n  id: number;\\n\\n  @ApiProperty()\\n  name: string;\\n}\\n\\nclass Photo {\\n  @ApiProperty({\\n    oneOf: [\\n      { type: \'string\' },\\n      {\\n        type: \'array\',\\n        items: {\\n          type: \'string\',\\n        },\\n      },\\n    ],\\n  })\\n  name: string | string[];\\n\\n  @ApiProperty({\\n    oneOf: [\\n      { type: Album },\\n      {\\n        type: \'array\',\\n        items: {\\n          type: () => Album,\\n        },\\n      },\\n    ],\\n  })\\n  album: Album | Album[];\\n}\\n```\\n\\n\\n\\n## koa\\n\\n\u63d0\u4f9b\u4e86 query \u7684 parse \u76f8\u5173\u914d\u7f6e\u3002\\n\\n\\n\\n## mwtsc \u5de5\u5177\\n\\n\u5207\u6362\u56de tsc \u81ea\u5e26\u7684\u76d1\u542c\uff0c\u7a33\u5b9a\u6027\u66f4\u597d\u3002\\n\\n\\n\\n## \u66f4\u591a\u7684\u53d8\u5316\\n\\n* \u4fee\u590d\u4e86\u4e00\u4e2a\u5065\u5eb7\u68c0\u67e5\u670d\u52a1\u4e22\u5931 this \u7684\u95ee\u9898\\n* \u53c2\u6570\u88c5\u9970\u5668\u589e\u52a0\u4e86\u4e00\u4e2a\u5f53\u524d\u5b9e\u4f8b\u7684\u53c2\u6570\\n\\n\u4ee5\u53ca\u4e00\u5927\u6279\u4f9d\u8d56\u8fdb\u884c\u4e86\u66f4\u65b0\uff0c\u53ef\u4ee5\u53c2\u8003\u6211\u4eec\u7684 [ChangeLog](https://midwayjs.org/changelog/v3.16.0)\u3002"},{"id":"release/3.15.0","metadata":{"permalink":"/en/blog/release/3.15.0","source":"@site/blog/2024-02-22-release-3.15.md","title":"Release 3.15.0","description":"\u5f00\u5de5\u5927\u5409\u3002","date":"2024-02-22T00:00:00.000Z","formattedDate":"February 22, 2024","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":0.96,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.15.0","title":"Release 3.15.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"Release 3.16.0","permalink":"/en/blog/release/3.16.0"},"nextItem":{"title":"Release 3.14.0","permalink":"/en/blog/release/3.14.0"}},"content":"\u5f00\u5de5\u5927\u5409\u3002\\n\\n\u5347\u7ea7\u8bf7\u53c2\u8003  [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\u672c\u6b21 3.15 \u7248\u672c\uff0c\u4e3b\u8981\u65b0\u589e\u4e86 MQTT \u7ec4\u4ef6\u3002\\n\\n\\n\\n## \u5168\u65b0\u7684 MQTT \u7ec4\u4ef6\\n\\n\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e `sub` \u548c `pub` \u521b\u5efa\u591a\u4e2a\u4e0d\u540c\u7684\u5b9e\u4f8b\uff0c\u65b9\u4fbf\u6ee1\u8db3\u7528\u6237\u9700\u6c42\u3002\\n\\n\u66f4\u591a\u7ec6\u8282\u53ef\u4ee5\u63a5\u7740\u67e5\u770b [\u6587\u6863](/docs/extensions/mqtt)\u3002\\n\\n\\n\\n## Swagger \u65b9\u6cd5\u7ea7\u522b\u7684 Security \u5ffd\u7565\\n\\n\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7 `@ApiExcludeSecurity` \u6765\u5ffd\u7565\u7279\u5b9a\u7684\u63a5\u53e3\u3002\\n\\n\\n\\n## mwtsc \u5de5\u5177\u652f\u6301\u4e86 Alias Path \u7684\u8bc6\u522b\u548c\u66ff\u6362\\n\\n\u73b0\u5728\u65b0\u5de5\u5177\u5df2\u7ecf\u53ef\u4ee5\u8ba4\u8bc6 Alias \u8def\u5f84\u4e86\u3002\\n\\n\\n\\n## \u66f4\u591a\u7684\u53d8\u5316\\n\\n* @koa/router \u5347\u7ea7\u5230\u4e86 v12 \u7248\u672c\\n* \u81ea\u5b9a\u4e49\u53c2\u6570\u88c5\u9970\u5668\u652f\u6301\u629b\u51fa\u5f02\u5e38\\n\\n\u6b64\u5916\uff0c\u8fd8\u6709\u4e00\u5927\u6279\u4f9d\u8d56\u8fdb\u884c\u4e86\u66f4\u65b0\uff0c\u66f4\u591a\u53ef\u4ee5\u53c2\u8003\u6211\u4eec\u7684 [ChangeLog](https://midwayjs.org/changelog/v3.15.0)\u3002"},{"id":"release/3.14.0","metadata":{"permalink":"/en/blog/release/3.14.0","source":"@site/blog/2024-01-13-release-3.14.md","title":"Release 3.14.0","description":"2024 \u65b0\u5e74\u5feb\u4e50\u3002","date":"2024-01-13T00:00:00.000Z","formattedDate":"January 13, 2024","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":4.235,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.14.0","title":"Release 3.14.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"Release 3.15.0","permalink":"/en/blog/release/3.15.0"},"nextItem":{"title":"Release 3.13.0","permalink":"/en/blog/release/3.13.0"}},"content":"2024 \u65b0\u5e74\u5feb\u4e50\u3002\\n\\n\u5347\u7ea7\u8bf7\u53c2\u8003  [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\u672c\u6b21 3.14 \u7248\u672c\uff0c\u91cd\u5199\u4e86 Cache \u7ec4\u4ef6\uff0c\u540c\u65f6\u4e5f\u5e26\u6765\u4e86\u4e00\u4e9b\u65b0\u7684\u7279\u6027\uff0c\u6211\u4eec\u5c06\u4e00\u4e00\u4ecb\u7ecd\u3002\\n\\n\\n\\n## \u5168\u65b0\u7684 CacheManager \u7ec4\u4ef6\\n\\n\u8fd9\u4e00\u7248\u672c\uff0cMidway \u5c06\u5e95\u5c42\u4f9d\u8d56\u7684 `cache-manager` \u6a21\u5757\u5347\u7ea7\u5230\u4e86 v5 \u7248\u672c\uff0c\u7531\u4e8e\u5b58\u5728 Breaking Change\uff0c\u542f\u7528\u4e86\u4e00\u4e2a\u65b0\u7684 `@midwayjs/cache-manager` \u7ec4\u4ef6\uff0c\u539f\u6709 `@midwayjs/cache` \u7ec4\u4ef6\u4e0d\u518d\u66f4\u65b0\u3002\\n\\n\u5728\u65b0\u7ec4\u4ef6\u4e2d\uff0c\u63d0\u4f9b\u4e86\u88c5\u9970\u5668 `@Caching` \u7528\u4e8e\u5feb\u901f\u7f13\u5b58\u51fd\u6570\u7ed3\u679c\u3002\\n\\n\u6bd4\u5982\uff1a\\n\\n```typescript\\n@Caching(\'default\', 100)\\nasync invokeData(name: string) {\\n  return name;\\n}\\n```\\n\\n\u90a3\u4e48\uff0c\u5728\u591a\u6b21\u8c03\u7528\u65f6\u5c31\u4f1a\u7f13\u5b58\u8fd4\u56de\u503c\uff0c\u5982\u679c\u8d85\u65f6\uff0c\u5219\u4f1a\u8fd4\u56de\u65b0\u7684\u503c\u3002\\n\\n```typescript\\nawait invokeData(\'harry\'); // => harry\\nawait invokeData(\'harry1\'); // => harry\\nawait invokeData(\'harry2\'); // => harry\\nawait sleep(100);\\nawait invokeData(\'harry3\'); // => harry3\\n```\\n\\n\u8fd9\u5728\u4e00\u4e9b\u6027\u80fd\u654f\u611f\u7684\u573a\u666f\u4f1a\u975e\u5e38\u6709\u7528\u3002\\n\\n\u6b64\u5916\uff0c`@Caching` \u88c5\u9970\u5668\u8fd8\u652f\u6301\u591a\u7ea7\u7f13\u5b58\uff0c\u5982\u679c\u4e00\u4e2a\u7f13\u5b58\u5b9e\u4f8b\u914d\u7f6e\u4e86\u591a\u4e2a Store\uff0c\u90a3\u4e48\u5b83\u5c06\u81ea\u52a8\u6839\u636e\u7f13\u5b58\u7684\u987a\u5e8f\u8fdb\u884c\u5904\u7406\u3002\\n\\n\u6700\u91cd\u8981\u7684\u4e00\u70b9\uff0c\u7ec4\u4ef6\u901a\u8fc7\u65b0\u8bbe\u8ba1\u5668\u7684 `createRedisStore` \u65b9\u6cd5\u652f\u6301\u590d\u7528 Redis \u7ec4\u4ef6\u7684\u914d\u7f6e\u4e86\u3002\\n\\n```typescript\\nimport { createRedisStore } from \'@midwayjs/cache-manager\';\\n\\n// src/config/config.default.ts\\nexport default {\\n  cacheManager: {\\n    clients: {\\n      default: {\\n        store: createRedisStore(\'default\'),\\n        // ...\\n      },\\n    },\\n  },\\n  redis: {\\n    clients: {\\n      default: {\\n        port: 6379,\\n        host: \'127.0.0.1\',\\n      }\\n    }\\n  }\\n}\\n```\\n\\n\u8fd9\u4e0b\u4e0d\u518d\u9700\u8981\u914d\u7f6e Redis \u591a\u904d\u4e86\u3002\\n\\n\u66f4\u591a\u529f\u80fd\u53ef\u4ee5\u63a5\u7740\u67e5\u770b [\u6587\u6863](/docs/extensions/caching)\u3002\\n\\n\\n\\n## Swagger \u7ec4\u4ef6\u7684\u5168\u65b0\u6e32\u67d3\u65b9\u5f0f\\n\\n\u7531\u4e8e\u4e4b\u524d\u7684\u7248\u672c\u65e0\u6cd5\u4f20\u9012 `swagger-ui` \u53c2\u6570\uff0c\u8fd9\u4e2a\u7248\u672c\u8bbe\u8ba1\u4e86\u4e00\u7ec4\u65b0\u7684 UI \u6e32\u67d3\u65b9\u5f0f\uff0c\u5c3d\u53ef\u80fd\u7684\u5e2e\u52a9\u5f00\u53d1\u8005\u81ea\u5b9a\u4e49 UI\u3002\\n\\n\u73b0\u5728\uff0c\u901a\u8fc7 `renderSwaggerUIDist` \uff0c`renderJSON` \u548c `renderSwaggerUIRemote` \u65b9\u6cd5\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u81ea\u5df1\u559c\u6b22\u7684\u65b9\u5f0f\u8fdb\u884c\u6e32\u67d3\u3002\\n\\n```typescript\\n// src/config/config.default.ts\\nimport { renderSwaggerUIRemote } from \'@midwayjs/swagger\';\\n\\nexport default {\\n  // ...\\n  swagger: {\\n    swaggerUIRender: renderSwaggerUIRemote,\\n    swaggerUIRenderOptions: {\\n      // ...\\n    }\\n  },\\n}\\n```\\n\\n\u53ea\u8981\u7f51\u7edc\u73af\u5883\u5141\u8bb8\uff0c\u5373\u4f7f\u4e0d\u518d\u5f15\u7528 `swagger-ui-dist` \u5305\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 CDN \u8d44\u6e90\u52a0\u8f7d UI\uff0c\u8fdb\u4e00\u6b65\u51cf\u8f7b\u670d\u52a1\u7aef\u538b\u529b\u3002\\n\\n\u4e5f\u53ef\u4ee5\u4ec5\u8f93\u51fa `Swagger JSON` \u5185\u5bb9\uff0c\u4e0d\u63d0\u4f9b UI\uff0c\u8fd9\u90fd\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u968f\u5fc3\u914d\u7f6e\u3002\\n\\n\\n\\n## \u670d\u52a1\u5de5\u5382\u5b9e\u4f8b\u652f\u6301\u4f18\u5148\u7ea7\\n\\n\u8fd9\u4e00\u7248\u672c\u53ef\u4ee5\u9488\u5bf9\u521b\u5efa\u51fa\u7684\u5b9e\u4f8b\u8bbe\u7f6e\u4e0d\u540c\u7684\u5b9e\u4f8b\u4f18\u5148\u7ea7\u3002\\n\\n\u6bd4\u5982\uff1a\\n\\n```typescript\\n// config.default.ts\\nimport { DEFAULT_PRIORITY } from \'@midwayjs/core\';\\n\\nexport default {\\n  redis: {\\n    clients: {\\n      instance1: {\\n        // ...\\n      },\\n      instance2: {\\n        // ...\\n      }\\n    },\\n    clientPriority: {\\n      instance1: DEFAULT_PRIORITY.L1,\\n      instance2: DEFAULT_PRIORITY.L3,\\n    }\\n  }\\n}\\n```\\n\\n\u5b9e\u4f8b\u4f18\u5148\u7ea7\u4e0d\u5f71\u54cd\u5b9e\u4f8b\u672c\u8eab\u7684\u529f\u80fd\uff0c\u4ec5\u5bf9\u5b9e\u73b0\u4e86\u4f18\u5148\u7ea7\u5224\u65ad\u7684\u5916\u90e8\u903b\u8f91\u751f\u6548\u3002\\n\\n\u6bd4\u5982\u5728\u5065\u5eb7\u68c0\u67e5\u65f6\u53ef\u4ee5\u6839\u636e\u4f18\u5148\u7ea7\u8fdb\u884c\u5ffd\u7565\uff0c\u4f4e\u4f18\u5148\u7ea7\u7684\u5b9e\u4f8b\u7b49\u4ef7\u4e8e\u5f31\u4f9d\u8d56\uff0c\u4f1a\u8df3\u8fc7\u5065\u5eb7\u68c0\u67e5\u3002\\n\\n\u8fd9\u4e00\u529f\u80fd\u76ee\u524d\u4ec5\u6709 `HealthService` \u5728\u4f7f\u7528\uff0c\u7406\u8bba\u4e0a\u522b\u7684\u903b\u8f91\u4e5f\u53ef\u80fd\u4f1a\u7528\u5230\uff0c\u6211\u4eec\u671f\u5f85\u66f4\u591a\u7684\u53ef\u80fd\u6027\u3002\\n\\n\\n\\n## \u66f4\u591a\u7684\u53d8\u5316\\n\\n* [mikro-orm](https://github.com/mikro-orm/mikro-orm/releases) \u4e8e 2024.01.08 \u65e5\u53d1\u5e03\u4e86 v6 \u7248\u672c\uff0c\u73b0\u5728 `@midwayjs/mikro` \u7ec4\u4ef6\u4e5f\u53ef\u4ee5\u914d\u5408 v6 \u7248\u672c\u4f7f\u7528\u4e86\\n* `@midwayjs/redis` \u589e\u52a0\u4e86\u57fa\u4e8e\u5b9e\u4f8b\u4f18\u5148\u7ea7\u7684\u5065\u5eb7\u68c0\u67e5\u903b\u8f91\\n* \u670d\u52a1\u5de5\u5382\u589e\u52a0\u4e86 `getClients()` \u548c `getClientKeys()` \u65b9\u6cd5\uff0c\u7528\u4e8e\u5feb\u901f\u8fed\u4ee3\u5b9e\u4f8b\\n* \u4fee\u590d\u4e86 swagger \u7ec4\u4ef6 ApiOperation \u76f8\u5173\u7684\u4e00\u4e9b\u95ee\u9898\\n* mwtsc \u5de5\u5177\u4fee\u590d\u4e86 windows \u4e0b\u5f00\u53d1\u7684\u95ee\u9898\\n* \u6587\u6863\u7684\u8fdb\u4e00\u6b65\u7cbe\u7b80\uff0c\u201c\u5176\u4ed6\u201d \u83dc\u5355\u5408\u5e76\u5230\u4e86 \u201c\u4f7f\u7528\u6587\u6863\u201d \u83dc\u5355\u4e2d\\n\\n\\n\\n\u6b64\u5916\uff0c\u8fd8\u6709\u4e00\u5927\u6279\u4f9d\u8d56\u8fdb\u884c\u4e86\u66f4\u65b0\uff0c\u66f4\u591a\u53ef\u4ee5\u53c2\u8003\u6211\u4eec\u7684 [ChangeLog](https://midwayjs.org/changelog/v3.14.0)\u3002"},{"id":"release/3.13.0","metadata":{"permalink":"/en/blog/release/3.13.0","source":"@site/blog/2023-11-13-release-3.13.md","title":"Release 3.13.0","description":"\u5347\u7ea7\u8bf7\u53c2\u8003  \u5982\u4f55\u66f4\u65b0 Midway \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002","date":"2023-11-13T00:00:00.000Z","formattedDate":"November 13, 2023","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":4.03,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.13.0","title":"Release 3.13.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"Release 3.14.0","permalink":"/en/blog/release/3.14.0"},"nextItem":{"title":"Release 3.12.0","permalink":"/en/blog/release/3.12.0"}},"content":"\u5347\u7ea7\u8bf7\u53c2\u8003  [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\u5728\u53cc\u5341\u4e00\u5927\u4fc3\u4e4b\u540e\uff0cMidway \u8fce\u6765\u4e86 3.13 \u7248\u672c\u3002\\n\\n\u8fd9\u4e2a\u7248\u672c\u4e3b\u8981\u8c03\u6574\u4e86\u5185\u7f6e\u7684 logger \u6a21\u5757\uff0c\u4f7f\u5176\u53ef\u4ee5\u652f\u6301 v3 \u7248\u672c\u7684 logger \u5e93\u3002\\n\\n\\n\\n## Breaking\\n\\n* 1\u3001\u672a\u58f0\u660e `@midwayjs/logger` \u4f9d\u8d56\u7684\u7528\u6237\u7684\u65e5\u5fd7\u4f1a\u51fa\u73b0\u610f\u5916\u9519\u8bef\\n* 2\u3001\u65e5\u5fd7\u7684\u914d\u7f6e\u5b9a\u4e49\u53ef\u80fd\u4e22\u5931\\n\\n\u8fd9\u4e24\u4e2a\u95ee\u9898\u7684\u89e3\u6cd5\u5728\u6700\u540e\u63cf\u8ff0\u3002\\n\\n\\n\\n## Feature\\n\\n### 1\u3001\u65e5\u5fd7\u5e93\u5347\u7ea7\u5230 v3\\n\\n\u7ecf\u8fc7\u4e00\u4e9b\u65f6\u95f4\u7684\u91cd\u5199\uff0cMidway \u642d\u914d\u7684 logger \u5e93\u4e5f\u5347\u7ea7\u5230\u4e86 v3 \u7248\u672c\uff0c\u5728 v3 \u7248\u672c\u4e2d\uff0c\u6211\u4eec\u79fb\u9664\u4e86 winston \u4f9d\u8d56\uff0c\u91cd\u5199\u4e86\u6574\u4e2a logger \u6a21\u5757\uff0c\u6027\u80fd\u51e0\u4e4e\u7ffb\u4e86\u4e00\u500d\u3002\\n\\n\u4ece [bundlephobia](https://bundlephobia.com/package/@midwayjs/logger) \u4e2d\u4e5f\u80fd\u770b\u5230\u5f88\u660e\u663e\u7684\u53d8\u5316\uff0c\u4ee3\u7801\u7684\u7cbe\u7b80\uff0c\u4f7f\u5f97\u8fd0\u884c\u66f4\u9ad8\u6548\uff0c\u4ee3\u7801\u66f4\u53d7\u63a7\u3002\\n\\n![](https://img.alicdn.com/imgextra/i2/O1CN01NYSvTT1VZzbFdR9nF_!!6000000002668-2-tps-3474-1726.png)\\n\\n\u4ece\u8fd9\u4e2a\u7248\u672c\u5f00\u59cb\uff0cMidway \u7684\u65e5\u5fd7\u5e93\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528 v2 \u6216\u8005 v3 \u7684\u65e5\u5fd7\u5e93\uff0c\u6ce8\u610f\u4e24\u8005\u7684\u914d\u7f6e\u662f\u4e0d\u540c\u7684\u3002\\n\\n\u5982\u679c\u4f60\u60f3\u67e5\u770b\u4e24\u4e2a\u7248\u672c\u7684\u53d8\u5316\uff0c\u53ef\u4ee5\u70b9\u51fb [\u8fd9\u91cc](https://github.com/midwayjs/logger/blob/main/BREAKING-3.md)\u3002\\n\\n\u5982\u679c\u4f60\u5e0c\u671b\u5347\u7ea7\u5230 v3 \u7248\u672c\u7684\u65e5\u5fd7\u5e93\uff0c\u6211\u4eec\u7684 [\u6587\u6863](/docs/logger) \u4e5f\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\u3002\\n\\n:::tip\\n\\n\u6ce8\u610f\uff0c\u5927\u7248\u672c\u5347\u7ea7\u8bf7\u8c28\u614e\uff0c\u5c3d\u53ef\u80fd\u9a8c\u8bc1\u529f\u80fd\u70b9\u3002\\n\\n:::\\n\\n\\n\\n### 2\u3001\u5185\u7f6e\u670d\u52a1\u65b0\u589e HealthService\\n\\nMidway \u4e00\u76f4\u6ca1\u6709\u63d0\u4f9b\u5185\u7f6e\u7684\u5065\u5eb7\u68c0\u67e5\u65b9\u6848\uff0c\u5728\u8fd9\u4e00\u7248\u672c\uff0c\u7ec8\u4e8e [\u8bbe\u8ba1](https://github.com/midwayjs/midway/issues/3370) \u4e86 HealthService \u8fd9\u4e00\u5185\u7f6e\u7684\u68c0\u67e5\u670d\u52a1\u3002\\n\\nHealthService \u7528\u4e8e\u63d0\u4f9b\u68c0\u67e5 API\uff0c\u5728\u4e0d\u540c\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u81ea\u884c\u63a5\u5165\u68c0\u67e5\u81ea\u5b9a\u4e49\u7ec4\u4ef6\u7684\u72b6\u6001\uff0c[\u6587\u6863\u5728\u6b64](/docs/built_in_service#midwayhealthservice)\u3002\\n\\n\u540c\u65f6\uff0c\u6211\u4eec\u7684 Configuration \u751f\u547d\u5468\u671f\u4e5f\u589e\u52a0\u4e86\u4e00\u4e2a `onHealthCheck` \u7684\u9636\u6bb5\uff0c\u7528\u4e8e\u5728\u6bcf\u6b21\u68c0\u67e5\u65f6\u6267\u884c\uff0c[\u6587\u6863\u5728\u6b64](/docs/lifecycle#onhealthcheck)\u3002\\n\\n\u8fd9\u4e00\u529f\u80fd\u76ee\u524d\u8fd8\u6ca1\u6709\u7ec4\u4ef6\u63a5\u5165\uff0c\u6211\u4eec\u5c06\u5728\u540e\u7eed\u7684\u7248\u672c\u4e2d\u9010\u6b65\u5b8c\u5584\u5b83\u3002\\n\\n\\n\\n## \u5176\u4ed6\u7684\u4e00\u4e9b\u53d8\u5316\\n\\n* 1\u3001jwt \u7ec4\u4ef6\u7684\u914d\u7f6e\u63d0\u4f9b\u66f4\u591a\u7684\u9009\u9879\uff0c\u6bd4\u5982 sign\uff0cverify\uff0cdecode \u7b49\u9009\u9879\\n* 2\u3001jwt \u7ec4\u4ef6\u5bfc\u51fa\u4e86\u9ed8\u8ba4\u7684 jwt \u5b9e\u4f8b\uff0c\u4f60\u53ef\u4ee5\u4ece\u4e0a\u9762\u83b7\u53d6\u5230\u4e00\u4e9b\u5185\u7f6e\u7684\u9519\u8bef\u5b9e\u4f8b\uff0c\u65b9\u4fbf\u8fc7\u6ee4\u5668\u62e6\u622a\\n* 3\u3001http-proxy \u7ec4\u4ef6\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7 enable \u914d\u7f6e\u6765\u5173\u95ed\u4e86\uff0c\u8fd9\u6837\u4f60\u53ef\u4ee5\u81ea\u884c\u5f15\u5165\u4e2d\u95f4\u4ef6\u505a\u66f4\u591a\u7684\u81ea\u5b9a\u4e49\u5904\u7406\\n* 4\u3001\u5728 web \u6846\u67b6\u4e2d\uff0ccontext.state \u7684\u7c7b\u578b\u73b0\u5728\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e86\uff0c\u8fd9\u5728\u6587\u6863\u4e2d\u4e5f\u8fdb\u884c\u4e86\u66f4\u65b0\\n* 5\u3001\u4fee\u590d\u4e86 static-file \u7ec4\u4ef6\u7684 namespace \u4e0d\u6b63\u786e\u7684\u95ee\u9898\\n* 6\u3001\u4fee\u590d\u4e86 framework \u52a0\u8f7d\u65f6\u4e3b\u6846\u67b6\u987a\u5e8f\u4e0d\u56fa\u5b9a\u7684\u95ee\u9898\\n\\n\\n\\n## \u89e3\u51b3\u65b9\u6848\\n\\n### 1\u3001\u65e5\u5fd7\u5e93\u4e22\u5931\u7684\u65b9\u6848\\n\\n\u7531\u4e8e\u5927\u90e8\u5206\u811a\u624b\u67b6\u6211\u4eec\u90fd\u5df2\u7ecf\u5f15\u5165\u4e86\u65e5\u5fd7\u5e93\u4f9d\u8d56\uff0c\u4e00\u822c\u6765\u8bf4\u4e0d\u9700\u8981\u5904\u7406\u3002\\n\\n\u5982\u679c\u672a\u5f15\u5165\u65e5\u5fd7\u5e93\uff0c\u6846\u67b6\u4f1a\u5728\u542f\u52a8\u65f6\u62a5\u9519\uff0c\u53ea\u9700\u8981\u5728 `package.json` \u7684\u4f9d\u8d56\u4e2d\u5199\u5165\u5373\u53ef\u3002\\n\\n```diff\\n\\"dependencies\\": {\\n+  \\"@midwayjs/logger\\": \\"^2.19.2\\",\\n},\\n```\\n\\n\u6ce8\u610f\uff0c\u53ea\u6709\u4e0a\u8ff0\u6700\u65b0\u7248\u672c\u7684\u65e5\u5fd7\u5e93\u624d\u517c\u5bb9 `v3.13.0` \u4ee5\u4e0a\u7684 `@midwayjs/core`\u3002\\n\\n\\n\\n### 2\u3001\u65e5\u5fd7\u7684\u914d\u7f6e\u5b9a\u4e49\u4e22\u5931\\n\\n\u7531\u4e8e ts \u7c7b\u578b\u5408\u5e76\u9700\u8981\u5728\u9879\u76ee\u4e2d\u663e\u5f0f\u58f0\u660e\u4e00\u6b21\uff0c\u4f60\u9700\u8981\u5728 `interface.ts` \u4e2d\u52a0\u5165\u4e0b\u9762\u7684\u4ee3\u7801\u3002\\n\\n```diff\\n+ import type {} from \'@midwayjs/logger\';\\n\\n/**\\n * @description User-Service parameters\\n */\\nexport interface IUserOptions {\\n  uid: number;\\n}\\n```\\n\\n\u8fd9\u6837\u5728 `src/config/config.default.ts` \u4e2d\u914d\u7f6e `midwayLogger` \u5b57\u6bb5\u65f6\uff0c\u65e5\u5fd7\u5e93\u7684\u5b9a\u4e49\u4f1a\u6062\u590d\u3002"},{"id":"release/3.12.0","metadata":{"permalink":"/en/blog/release/3.12.0","source":"@site/blog/2023-08-14-release-3.12.md","title":"Release 3.12.0","description":"\u5347\u7ea7\u8bf7\u53c2\u8003  \u5982\u4f55\u66f4\u65b0 Midway \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002","date":"2023-08-14T00:00:00.000Z","formattedDate":"August 14, 2023","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":2.485,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.12.0","title":"Release 3.12.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"Release 3.13.0","permalink":"/en/blog/release/3.13.0"},"nextItem":{"title":"\u79fb\u9664 Node.js v14 \u7684 CI \u73af\u5883","permalink":"/en/blog/remove-node-14-ci"}},"content":"\u5347\u7ea7\u8bf7\u53c2\u8003  [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\u5728\u7ecf\u8fc7\u4e86\u51e0\u4e2a\u6708\u7684\u52aa\u529b\u66f4\u65b0\u4e4b\u540e\uff0cMidway \u8fce\u6765\u4e86 3.12 \u7248\u672c\uff0c\u8fd9\u662f\u4e00\u4e2a\u6539\u52a8\u6bd4\u8f83\u5927\u7684\u7248\u672c\u3002\\n\\n\\n\\n## Breaking\\n\\n\u4ece v3.12.0 \u5f00\u59cb\uff0cMidway \u79fb\u9664\u4e86 Node.js v14 \u7684 CI\uff0c\u539f\u56e0\u8bf7\u53c2\u8003 [\u8fd9\u91cc](/blog/remove-node-14-ci)\u3002\\n\\n\\n\\n## Features\\n\\n### 1\u3001ESM \u7684\u652f\u6301\\n\\n\u4ece v3.12.0 \u5f00\u59cb\uff0cmidway \u652f\u6301\u521b\u5efa ESModule \u9879\u76ee\uff0c\u4f7f\u7528\u65f6\u548c\u4f20\u7edf CJS \u9879\u76ee\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u7531\u4e8e\u65f6\u95f4\u7d27\u8feb\uff0c\u6211\u4eec\u6ca1\u6709\u9488\u5bf9\u6240\u6709\u7684\u7ec4\u4ef6\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5982\u6709\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u8bf7\u63d0\u4ea4 issue\u3002\\n\\n\u6b64\u5916\uff0c\u7531\u4e8e\u539f\u6709\u7684\u5de5\u5177\u4f53\u7cfb\u5df2\u7ecf\u65e0\u6cd5\u5f88\u597d\u7684\u517c\u5bb9 ESM \u73af\u5883\uff0c\u4e3a\u4e86\u51cf\u5c11\u7ef4\u62a4\u6210\u672c\uff0c\u6211\u4eec\u542f\u7528\u4e86\u4e00\u5957\u5168\u65b0\u7684\u5de5\u5177\u94fe\uff0c\u540e\u7eed\u666e\u901a CJS \u9879\u76ee\u4e5f\u4f1a\u7edf\u4e00\u5230\u8fd9\u4e00\u5957\u4e0a\u6765\u3002\\n\\n\u66f4\u591a\u7ec6\u8282\u8bf7\u67e5\u770b [ESM \u6587\u6863](/docs/esm)\u3002\\n\\n\\n\\n### 2\u3001FaaS \u67b6\u6784\u53d8\u66f4\\n\\n\u4ece v3.12.0 \u5f00\u59cb\uff0cMidway FaaS \u4f7f\u7528\u5168\u65b0\u7684\u4e00\u5957\u67b6\u6784\u652f\u6301\u73b0\u6709\u7684 Serverless \u5e73\u53f0\uff0c\u8fd9\u4e00\u90e8\u5206\u540e\u7eed\u5c06\u4f1a\u5728\u6587\u6863\u4e2d\u4f53\u73b0\u3002\\n\\n\u4e3b\u8981\u7684\u53d8\u5316\uff1a\\n\\n- Midway \u4e0d\u518d\u63d0\u4f9b \u201c\u5e94\u7528\u90e8\u7f72\u5230\u5f39\u6027\u5bb9\u5668\u201d \u7684\u517c\u5bb9\u65b9\u6848\uff0c\u5982\u679c\u5e73\u53f0\u652f\u6301\u4f7f\u7528\u4f20\u7edf\u5e94\u7528\u90e8\u7f72 Serverless \u5bb9\u5668\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6807\u51c6\u9879\u76ee\u90e8\u7f72\\n- Midway \u4e0d\u518d\u63d0\u4f9b f.yml \u7684\u7ef4\u62a4\u5de5\u4f5c\uff0c\u4e5f\u4e0d\u518d\u63d0\u4f9b\u90e8\u7f72\u529f\u80fd\uff0c\u4ec5\u63d0\u4f9b\u5c06\u73b0\u6709\u51fd\u6570\u4fe1\u606f\u5199\u5165\u5e73\u53f0\u914d\u7f6e\u7684\u80fd\u529b\uff0c\u6240\u6709\u7684\u51fd\u6570\u90e8\u7f72\u5c06\u7531\u5e73\u53f0\u81ea\u5df1\u7684\u5de5\u5177\u8fdb\u884c\u90e8\u7f72\\n- \u79fb\u9664\u4e86\u539f\u6709\u901a\u8fc7 `@midwayjs/serverless-app` \u542f\u52a8\u548c\u5f00\u53d1\u7684\u6a21\u5f0f\uff0c\u4f5c\u4e3a\u66ff\u4ee3\uff0c\u5c06\u4f7f\u7528 `@midwayjs/fc-starter` \u6765\u8fdb\u884c\u5f00\u53d1\\n\\n\\n\\n## \u5176\u4ed6\u7684\u4e00\u4e9b\u53d8\u5316\\n\\n\\n\\n- 1\u3001\u6dfb\u52a0\u4e86 `ctx.getApp()` \u65b9\u6cd5\uff0c\u53ef\u4ee5\u4ece ctx \u62ff\u5230\u81ea\u5df1 app\uff0c\u6253\u901a\u4e86\u6574\u6761\u4ece framework\uff0c\u5230 app \u548c ctx \u7684\u94fe\u8def\\n\\n- 2\u3001core \u4e2d\u7684 httpClient \u73b0\u5728\u652f\u6301\u4e86\u6240\u6709\u7684 http method\\n\\n- 3\u3001\u589e\u52a0\u4e86\u4e00\u4e2a\u5185\u90e8\u8df3\u8f6c URL \u7684 api\uff0c`ctx.forward`\\n\\n- 4\u3001IoC \u5bb9\u5668\u589e\u52a0\u4e86\u4e00\u4e2a\u83b7\u53d6\u5bf9\u8c61\u4f5c\u7528\u57df\u7684 API\uff0c`container.getInstanceScope(xxx)`\\n\\n  \\n\\n  \\n\\n## \u4f9d\u8d56\u66f4\u65b0\\n\\n\\n\u5177\u4f53\u53ef\u4ee5\u67e5\u770b [Changelog](https://midwayjs.org/changelog/v3.12.0)\u3002"},{"id":"remove-node-14-ci","metadata":{"permalink":"/en/blog/remove-node-14-ci","source":"@site/blog/2023-08-13-remove-node-14-ci.md","title":"\u79fb\u9664 Node.js v14 \u7684 CI \u73af\u5883","description":"\u6700\u8fd1\u4e00\u6bb5\u65f6\u95f4\uff0c\u6211\u4eec\u53d1\u73b0\u8d8a\u6765\u8d8a\u591a\u7684\u5e93\u79fb\u9664\u4e86 Node.js v14 \u7684\u652f\u6301\u3002","date":"2023-08-13T00:00:00.000Z","formattedDate":"August 13, 2023","tags":[{"label":"node","permalink":"/en/blog/tags/node"}],"readingTime":1.155,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"remove-node-14-ci","title":"\u79fb\u9664 Node.js v14 \u7684 CI \u73af\u5883","authors":["harry"],"tags":["node"]},"prevItem":{"title":"Release 3.12.0","permalink":"/en/blog/release/3.12.0"},"nextItem":{"title":"Release 3.11.0","permalink":"/en/blog/release/3.11.0"}},"content":"\u6700\u8fd1\u4e00\u6bb5\u65f6\u95f4\uff0c\u6211\u4eec\u53d1\u73b0\u8d8a\u6765\u8d8a\u591a\u7684\u5e93\u79fb\u9664\u4e86 Node.js v14 \u7684\u652f\u6301\u3002\\n\\n\u6709\u4e9b\u5e93\u662f\u5347\u7ea7\u7684\u5927\u7248\u672c\uff0c\u6709\u4e9b\u5e93\u4ec5\u4ec5\u53ea\u5347\u7ea7 minor \u7248\u672c\uff0c\u8fd9\u4f7f\u5f97\u4f9d\u8d56\u4ed6\u4eec\u7684\u4e1a\u52a1\u3001\u6a21\u5757\u4e43\u81f3\u6846\u67b6\u90fd\u5f88\u96be\u4fe1\u4efb\u793e\u533a\u7684 SemVer \u7248\u672c\u7ea6\u5b9a\u4e86\u3002\\n\\n\u4e3a\u4e86\u4fdd\u6301 Midway \u7684\u5355\u6d4b\u6b63\u5e38\u8fd0\u884c\uff0c\u4ece v3.12.0 \u5f00\u59cb\uff0cMidway \u79fb\u9664\u4e86 Node.js v14 \u7684 CI\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u65e0\u6cd5\u6d4b\u8bd5 Node.js v16 \u4ee5\u4e0b\u793e\u533a\u5e93\u7684\u517c\u5bb9\u6027\uff0c\u53ea\u80fd\u9760\u793e\u533a\u5e93\u66f4\u65b0\u7684 Changelog \u4ee5\u53ca\u6211\u4eec\u7684\u7ecf\u9a8c\u6765\u4fdd\u8bc1\u3002\\n\\n\u5982\u679c\u6211\u4eec\u53d1\u73b0\u67d0\u4e9b\u5e93\u53ea\u652f\u6301\u7279\u5b9a\u7248\u672c\u7684 Node.js\uff0c\u6211\u4eec\u4f1a\u5728 `package.json` \u4e2d\u8fdb\u884c\u7248\u672c\u9650\u5236\uff0c\u5982\u679c\u4f60\u53d1\u73b0\u67d0\u4e9b\u5e93\u7684\u7248\u672c\u66f4\u65b0\u65e0\u6cd5\u5728\u4f4e\u7248\u672c Node.js \u4e2d\u8fd0\u884c\uff0c\u4e14 Midway \u7684\u7ec4\u4ef6\u6ca1\u6709\u8fdb\u884c\u9650\u5236\uff0c\u8bf7\u901a\u77e5\u6211\u4eec\u3002\\n\\n\u6700\u540e\u518d\u6b21\u63d0\u9192\uff0c\u5982\u679c\u6ca1\u6709\u5f3a\u9700\u6c42\uff0c\u8bf7\u4f7f\u7528 Node.js v16 \u4ee5\u4e0a\u7248\u672c\u3002"},{"id":"release/3.11.0","metadata":{"permalink":"/en/blog/release/3.11.0","source":"@site/blog/2023-03-27-release-3.11.md","title":"Release 3.11.0","description":"\u5347\u7ea7\u8bf7\u53c2\u8003  \u5982\u4f55\u66f4\u65b0 Midway \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002","date":"2023-03-27T00:00:00.000Z","formattedDate":"March 27, 2023","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":2.245,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.11.0","title":"Release 3.11.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"\u79fb\u9664 Node.js v14 \u7684 CI \u73af\u5883","permalink":"/en/blog/remove-node-14-ci"},"nextItem":{"title":"Release 3.10.0","permalink":"/en/blog/release/3.10.0"}},"content":"\u5347\u7ea7\u8bf7\u53c2\u8003  [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\u5f88\u9ad8\u5174\u7ed9\u5927\u5bb6\u4ecb\u7ecd\u6211\u4eec\u7684 3.11 \u65b0\u7248\u672c\u3002\\n\\n\\n\\n## \u5b89\u5168\u6027\u66f4\u65b0\\n\\nUpload \u7ec4\u4ef6\u589e\u52a0\u4e86\u5b89\u5168\u6027\u6027\u80fd\uff0c\u5728 `file` \u4e0a\u4f20\u6a21\u5f0f\u4e0b\uff0c\u6211\u4eec\u53d1\u73b0\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u6587\u4ef6\u7684\u540e\u7f00\u548c\u5b9e\u9645\u5185\u5bb9\u4e0d\u5339\u914d\uff0c\u5bfc\u81f4\u53ef\u80fd\u4f1a\u5728\u670d\u52a1\u5668\u88ab\u52a8\u6267\u884c\u7684\u5b89\u5168\u6027\u6f0f\u6d1e\u3002\\n\\n\u65b0\u7248\u672c\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e2a MIME \u914d\u7f6e\uff0c\u53ef\u4ee5\u5728\u4e0a\u4f20\u65f6\u68c0\u67e5\u6269\u5c55\u540d\u4e4b\u5916\uff0c\u989d\u5916\u68c0\u67e5 MIME \u7684\u7c7b\u578b\uff0c\u4f1a\u66f4\u52a0\u5b89\u5168\u3002\\n\\n```typescript\\nexport default {\\n  // ...\\n  upload: {\\n    // ...\\n    // \u4ec5\u5141\u8bb8\u4e0b\u9762\u8fd9\u4e9b\u6587\u4ef6\u7c7b\u578b\u53ef\u4ee5\u4e0a\u4f20\\n    mimeTypeWhiteList: {\\n      \'.jpg\': \'image/jpeg\',\\n    }\\n  },\\n}\\n```\\n\\n\u66f4\u591a\u7ec6\u8282\u53ef\u4ee5\u67e5\u770b\u6211\u4eec\u7684 [Upload \u7ec4\u4ef6](/docs/extensions/upload)\u3002\\n\\n\\n\\n## New Feature\\n\\n\\n\\n### \u7cbe\u7ec6\u5316\u7684 Mock \u80fd\u529b\\n\\n\u57fa\u4e8e\u6846\u67b6\u65b0\u63d0\u4f9b\u7684 `@Mock` \u88c5\u9970\u5668\uff0c\u53ef\u4ee5\u65b9\u4fbf\u7684\u5728\u4e0d\u540c\u7684\u9636\u6bb5\u8fdb\u884c\u6570\u636e\u6a21\u62df\u3002\u540c\u65f6\u4f5c\u4e3a\u903b\u8f91\u7684\u4e00\u90e8\u5206\uff0c\u8fd9\u4e2a\u529f\u80fd\u53ef\u4ee5\u5728\u5f00\u53d1\u548c\u6d4b\u8bd5\u671f\u88ab\u81ea\u52a8\u6267\u884c\uff0c\u65b9\u4fbf\u7528\u6237\u7684\u5f00\u53d1\u671f\u6a21\u62df\u6570\u636e\u3002\\n\\n\u6587\u6863\u8bf7\u53c2\u8003 [\u6570\u636e\u6a21\u62df](/docs/mock)\u3002\\n\\n\\n\\n### \u4e2d\u95f4\u4ef6\u7684 Match/Ignore\\n\\nMiddleware \u7684\u529f\u80fd\u8fdb\u4e00\u6b65\u589e\u5f3a\uff0cmatch \u548c ignore \u73b0\u5728\u53ef\u4ee5\u662f `string` \uff0c`regexp`\uff0c`function` \u6216\u8005\u4ed6\u4eec\u7684\u6570\u7ec4\u7ec4\u5408\u5f62\u5f0f\u3002\\n\\n\\n\\n### \u672c\u5730\u5b9a\u65f6\u4efb\u52a1\u7ec4\u4ef6\\n\\n\u4e4b\u524d\u6211\u4eec\u63d0\u4f9b\u4e86 bull \u7ec4\u4ef6\uff0c\u7528\u4e8e\u5206\u5e03\u5f0f\u5b9a\u65f6\u4efb\u52a1\uff0c\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u4f9d\u65e7\u9700\u8981\u5355\u673a\u7684\u5b9a\u65f6\u4efb\u52a1\u6765\u8d4b\u503c\u5b8c\u6210\u4e00\u4e9b\u4e8b\u9879\uff0c\u539f\u6709\u7684 task \u7ec4\u4ef6\u5b9e\u73b0\u4e86 cron \u7684\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u5176\u5206\u79bb\u4e3a `cron` \u7ec4\u4ef6\uff0c\u7ee7\u7eed\u63d0\u4f9b\u80fd\u529b\u652f\u6301\u3002 \\n\\n\u6587\u6863\u8bf7\u53c2\u8003 [cron \u7ec4\u4ef6](/docs/extensions/cron)\u3002\\n\\n\\n\\n### \u6807\u7b7e\u7ec4\u4ef6\\n\\n\u4e00\u79cd\u62bd\u8c61\u5316\u7684\u670d\u52a1\u7aef\u80fd\u529b\uff0c\u7528\u4e8e\u6570\u636e\u7b5b\u9009\u548c\u5904\u7406\u3002\\n\\n\u6587\u6863\u8bf7\u53c2\u8003 [\u6807\u7b7e\u7ec4\u4ef6](/docs/extensions/tags)\u3002"},{"id":"release/3.10.0","metadata":{"permalink":"/en/blog/release/3.10.0","source":"@site/blog/2023-01-30-release-3.10.md","title":"Release 3.10.0","description":"\u65b0\u5e74\u5feb\u4e50\u3002","date":"2023-01-30T00:00:00.000Z","formattedDate":"January 30, 2023","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":3.685,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.10.0","title":"Release 3.10.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"Release 3.11.0","permalink":"/en/blog/release/3.11.0"},"nextItem":{"title":"Release 3.9.0","permalink":"/en/blog/release/3.9.0"}},"content":"\u65b0\u5e74\u5feb\u4e50\u3002\\n\\n\u5347\u7ea7\u8bf7\u53c2\u8003  [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\u8fd9\u4e2a\u7248\u672c\u66f4\u65b0\u4e86\u8bb8\u591a\u4e1c\u897f\uff0c\u8bf7\u8010\u5fc3\u770b\u5b8c\u3002\\n\\n\\n\\n## Breaking\\n\\n\u9996\u5148\u662f Breaking \u7684\u90e8\u5206\uff0c\u8fd9\u90e8\u5206\u5e76\u975e\u662f\u6846\u67b6\u672c\u8eab\u7684 API \u53d8\u66f4\uff0c\u800c\u662f\u4f9d\u8d56\u6216\u8005\u884c\u4e3a\u53ef\u80fd\u4f1a\u5f71\u54cd\u5c11\u90e8\u5206\u7528\u6237\uff0c\u9700\u8981\u6ce8\u610f\u7684\u90e8\u5206\u3002\\n\\n- 1\u3001 `@midwayjs/consul` \u4f9d\u8d56\u7684 `consul` \u6a21\u5757\u4ece `0.x` \u5347\u7ea7\u5230 `v1` \u6b63\u5f0f\u7248\uff0cAPI \u53ef\u80fd\u6709\u66f4\u65b0\uff08`consul.acl` \u53d8\u66f4\u4e3a `consul.acl.legacy`\uff09\uff0c\u5177\u4f53\u8bf7\u67e5\u770b [\u6587\u6863](https://github.com/silas/node-consul#acl-legacy)\\n- 2\u3001`@midwayjs/jwt` \u4f9d\u8d56\u7684`jsonwebtoken` \u6a21\u5757\u7531\u4e8e\u5b89\u5168\u6027\u95ee\u9898\uff0c\u4ece `v8` \u5347\u7ea7\u5230 `v9`\uff0cAPI \u53ef\u80fd\u6709\u66f4\u65b0\uff0c\u66f4\u591a\u60c5\u51b5\u8bf7\u67e5\u770b [\u6587\u6863](https://github.com/midwayjs/midway/pull/2595)\\n- 3\u3001\u7531\u4e8e\u65b0\u589e\u7684 `@Pipe` \u529f\u80fd\uff0c`@midwayjs/validate` \u65b0\u7248\u672c\u65e0\u9700\u4f7f\u7528 `@Validate` \u88c5\u9970\u5668\u5373\u53ef\u6821\u9a8c\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u4e00\u90e8\u5206\u4e4b\u524d\u672a\u7f16\u5199\u88c5\u9970\u5668\u4f46\u662f\u65b0\u7248\u672c\u5374\u88ab\u9a8c\u8bc1\u7684\u573a\u666f\uff0c\u5177\u4f53\u8bf7\u770b\u4e0b\u9762\u5173\u4e8e `@Pipe` \u7684\u4ecb\u7ecd\u6216\u8005\u76f8\u5173\u7684\u6587\u6863\u3002\\n\\n\\n\\n## New Feature\\n\\n\\n\\n### Pipe\\n\\n\u65b0\u7248\u672c\u65b0\u589e\u4e86\u4e00\u9879 Pipe \u80fd\u529b\uff0c\u53ef\u4ee5\u4f7f\u53c2\u6570\u88c5\u9970\u5668\u7684\u80fd\u529b\u66f4\u8fdb\u4e00\u6b65\u3002\\n\\n\u85c9\u7531\u6b64\u80fd\u529b\uff0c\u65b0\u7248\u672c\u7684 Validate \u7ec4\u4ef6\u4e0d\u518d\u9700\u8981 `@Validate` \u88c5\u9970\u5668\uff0c\u4ee3\u7801\u4f1a\u66f4\u52a0\u7b80\u6d01\u3002\\n\\n\u65e7\uff1a\\n\\n```typescript\\n@Controller(\'/api/user\')\\nexport class HomeController {\\n\\n  @Post(\'/\')\\n  @Validate()\\n  async updateUser(@Body() user: UserDTO ) {\\n    // user.id\\n  }\\n}\\n```\\n\\n\u65b0\uff1a\\n\\n```typescript\\n@Controller(\'/api/user\')\\nexport class HomeController {\\n\\n  @Post(\'/\')\\n  async updateUser(@Body() user: UserDTO ) {\\n    // user.id\\n  }\\n}\\n```\\n\\n\u9488\u5bf9\u975e DTO \u7c7b\u578b\u7684\u6821\u9a8c\uff0c\u73b0\u5728\u4e5f\u53ef\u4ee5\u4f7f\u7528 Pipe \u8fdb\u884c\u5904\u7406\uff0c\u5982\u679c\u662f\u5b57\u7b26\u4e32\uff0c\u4f1a\u81ea\u52a8\u8f6c\u4e3a\u6570\u5b57\uff0c\u5e76\u8fdb\u884c\u6821\u9a8c\u3002\\n\\n```typescript\\n@Controller(\'/api/user\')\\nexport class HomeController {\\n\\n  @Post(\'/update_age\')\\n  async updateAge(@Body(\'age\', [ParseIntPipe]) age: number ) {\\n    // ...\\n  }\\n}\\n```\\n\\n\u5f53\u7136 Pipe \u7684\u529f\u80fd\u4e0d\u4ec5\u5982\u6b64\uff0c\u66f4\u591a\u529f\u80fd\u8bf7\u67e5\u770b [\u5b8c\u6574\u6587\u6863](/docs/pipe)\u3002\\n\\n\\n\\n### TypeORM Logger\\n\\n\u5f53 typeorm \u7ec4\u4ef6\u672a\u914d\u7f6e logger \u5c5e\u6027\u65f6\uff0c\u65b0\u7248\u672c\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a `typeormLogger` \u7528\u4e8e\u5b58\u50a8\u6267\u884c\u7684 sql\u3002\\n\\n\u9ed8\u8ba4\u914d\u7f6e\u4e3a\uff1a\\n\\n```typescript\\nmidwayLogger: {\\n  clients: {\\n    typeormLogger: {\\n      lazyLoad: true,\\n      fileLogName: \'midway-typeorm.log\',\\n      enableError: false,\\n      level: \'info\',\\n    },\\n  },\\n}\\n```\\n\\n`lazyLoad` \u4e3a\u65b0\u589e\u7684\u5c5e\u6027\uff0c\u53ef\u4ee5\u4f7f logger \u5728\u4e00\u5f00\u59cb\u4ec5\u4fdd\u7559\u914d\u7f6e\uff0c\u7b49\u5b9e\u9645 getLogger \u65f6\u624d\u505a\u521d\u59cb\u5316\u3002\\n\\n\\n\\n### @Singleton \u88c5\u9970\u5668\\n\\n\u7b80\u5316\u539f\u6709\u7684\u5199\u6cd5\uff1a\\n\\n\u65e7\uff1a\\n\\n```typescript\\n@Scope(ScopeEnum.Singleton)\\n@Provide()\\nclass SingletonService {}\\n```\\n\\n\u65b0\uff1a\\n\\n```typescript\\n@Singleton()\\nclass SingletonService {}\\n```\\n\\n\\n\\n### app.getNamespace API\\n\\n\u901a\u8fc7 app \u4e0a\u65b0\u589e\u7684 `getNamespace` API \uff0c\u53ef\u4ee5\u83b7\u53d6\u5230\u5f53\u524d\u7684 app \u5f52\u5c5e\u6846\u67b6\u7684\u7c7b\u578b\u3002\\n\\n\u6bd4\u5982\uff1a\\n\\n```typescript\\nimport { Application } from \'@midwayjs/web\';\\n\\n@Controller()\\nclass HomeController {\\n\\n  @App()\\n  app: Application;\\n\\n  async invoke() {\\n    // this.app.getNamespace()  => \'egg\'\\n  }\\n}\\n```\\n\\n\\n\\n## \u5176\u4ed6\u7684\u4e00\u4e9b\u53d8\u5316\\n\\n- 1\u3001\u8c03\u6574`@midwayjs/core` \u9ed8\u8ba4 logger level \u4e3a info\uff0c\u7684 `coreLogger` \u5728\u670d\u52a1\u5668\u73af\u5883\u7ee7\u7eed\u4fdd\u7559 warn\\n- 2\u3001faas \u6a21\u5757\u65b0\u589e\u4e00\u4e9b\u81ea\u5b9a\u4e49\u89e6\u53d1\u5668\u7c7b\u578b\\n- 3\u3001\u5728 jest \u6d4b\u8bd5\u73af\u5883\u4e0b\uff0c\u521d\u59cb\u5316\u7684\u62a5\u9519\u4e4b\u524d\u4f1a\u88ab jest \u541e\u6389\uff0c\u65b0\u7248\u672c\u4f1a\u901a\u8fc7 `console.error` \u8fdb\u884c\u8f93\u51fa\\n- 4\u3001\u4fee\u590d `configuration` \u7684 stop \u751f\u547d\u5468\u671f\uff0c\u5c06\u4ee5 `imports` \u987a\u5e8f\u7684\u9006\u5e8f\u6267\u884c\\n- 5\u3001\u4fee\u590d `bootstrap` \u4f7f\u7528 sticky \u6a21\u5f0f\u65f6\uff0c\u6587\u4ef6\u4e0a\u4f20\u65f6\u7684\u9519\u8bef\\n- 6\u3001\u652f\u6301 swager \u7684\u5c5e\u6027\u591a\u7c7b\u578b\u5c55\u793a\\n- 7\u3001\u5728 `midway-bin dev` \u4e0b\uff0c\u5e94\u7528\u5728\u672c\u5730\u5f00\u53d1\u65f6\u4e5f\u53ef\u4ee5\u5feb\u901f\u4f7f\u7528 `--ssl` \u6765\u542f\u52a8 https \u670d\u52a1"},{"id":"release/3.9.0","metadata":{"permalink":"/en/blog/release/3.9.0","source":"@site/blog/2022-12-13-release-3-9.md","title":"Release 3.9.0","description":"\u5927\u4fc3\u79ef\u6512\u4e86\u7ea6\u4e24\u5468\u7684\u9700\u6c42\uff0c\u7edf\u4e00\u5728 v3.9.0 \u53d1\u5e03\u3002","date":"2022-12-13T00:00:00.000Z","formattedDate":"December 13, 2022","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":3.295,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.9.0","title":"Release 3.9.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"Release 3.10.0","permalink":"/en/blog/release/3.10.0"},"nextItem":{"title":"Release 3.8.0","permalink":"/en/blog/release/3.8.0"}},"content":"\u5927\u4fc3\u79ef\u6512\u4e86\u7ea6\u4e24\u5468\u7684\u9700\u6c42\uff0c\u7edf\u4e00\u5728 v3.9.0 \u53d1\u5e03\u3002\\n\\n\u5347\u7ea7\u8bf7\u53c2\u8003  [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\\n\\n## Breaking\\n\\n\u4ece v3.9.0 \u5f00\u59cb\uff0cMidway \u4ec5\u652f\u6301 Node.js ` >=12.11.0` \u7248\u672c\u3002\\n\\n\\n\\n## Features\\n\\n\\n\\n### 1\u3001bootstrap \u65b0\u589e\u8fdb\u7a0b\u6a21\u578b\\n\\n\u4ece v3.9.0 \u5f00\u59cb\uff0c\u4e3a\u4e86\u5e94\u5bf9 socket.io \u5728 pm2 \u573a\u666f\u4e0b\u7684\u7c98\u6027\u4f1a\u8bdd\uff0c\u6211\u4eec\u65b0\u589e\u4e00\u79cd master-worker \u6a21\u578b\u652f\u6301\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u5c06\u7531 pm2 \u6765\u542f\u52a8 midway \u7684 master\uff0c\u5728 master \u542f\u52a8 worker\uff0c\u8fd9\u6837\u53ef\u4ee5\u76f8\u5bf9\u81ea\u7531\u7684\u5b9a\u5236 master \u4e2d\u7684\u903b\u8f91\u3002\\n\\n\u539f\u6709\u7684 `Bootstrap` \u4e4b\u5916\uff0c\u65b0\u589e\u4e86\u4e00\u4e2a `ClusterManager` \u6765\u5904\u7406\u8fdb\u7a0b\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a\\n\\n```typescript\\nconst { ClusterManager, Bootstrap } = require(\'@midwayjs/bootstrap\');\\n\\nconst clusterManager = new ClusterManager({\\n  // \u6267\u884c\u7684\u5b50\u8fdb\u7a0b\u6587\u4ef6\\n  exec: __filename,\\n  // \u8fdb\u7a0b\u6570\\n  count: 2,\\n});\\n\\nif (clusterManager.isPrimary()) {\\n  // \u542f\u52a8\u4e3b\u8fdb\u7a0b\\n  clusterManager.start();\\n} else {\\n  // \u539f\u6709\u5b50\u8fdb\u7a0b\u6267\u884c\\n  Bootstrap.run();\\n}\\n```\\n\\n\u5173\u4e8e socket.io \u7684\u7c98\u6027\u4f1a\u8bdd\uff0c\u6211\u4eec\u5c06\u5728 socket.io \u7ec4\u4ef6\u4e2d\u4ecb\u7ecd\u66f4\u591a\u3002\\n\\n\\n\\n### 2\u3001\u589e\u52a0 @InjectClient \u652f\u6301\\n\\n\u4e3a ServiceFactory \u7c7b\u578b\u6dfb\u52a0\u4e00\u4e2a `@InjectClient` \u88c5\u9970\u5668\uff0c\u65b9\u4fbf\u5728\u591a\u5ba2\u6237\u7aef\u7684\u7684\u65f6\u5019\u9009\u62e9\u6ce8\u5165\u3002\\n\\n\u6bd4\u5982\u4f7f\u7528\u591a\u4e2a redis \u7ec4\u4ef6\u7684\u65f6\u5019\u3002\\n\\n\u539f\u6765\uff1a\\n\\n```typescript\\nimport { RedisServiceFactory } from \'@midwayjs/redis\';\\nimport { join } from \'path\';\\n\\n@Provide()\\nexport class UserService {\\n\\n  @Inject()\\n  redisServiceFactory: RedisServiceFactory;\\n\\n  async save() {\\n    const redis1 = this.redisServiceFactory.get(\'instance1\');\\n    const redis2 = this.redisServiceFactory.get(\'instance2\');\\n\\n    //...\\n\\n  }\\n}\\n```\\n\\n\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7\u6ce8\u5165\u6765\u7b80\u5316\u3002\\n\\n```typescript\\nimport { RedisServiceFactory } from \'@midwayjs/redis\';\\nimport { InjectClient } from \'@midwayjs/core\';\\n\\n@Provide()\\nexport class UserService {\\n\\n  @InjectClient(RedisServiceFactory, \'instance1\')\\n  redis1: RedisService;\\n  \\n  @InjectClient(RedisServiceFactory, \'instance2\')\\n  redis2: RedisService;\\n\\n  async save() {\\n    // this.redis1.set(...)\\n    // this.redis2.set(...)\\n  }\\n}\\n```\\n\\n\u6ce8\u610f\uff0c\u6240\u6709\u7ee7\u627f\u4e8e ServiceFactory \u7684\u591a\u5b9e\u4f8b\u7ec4\u4ef6\u90fd\u53ef\u4ee5\u4f7f\u7528\u4e0a\u8ff0\u65b9\u6cd5\u3002\\n\\n\\n\\n### 3\u3001casbin \u652f\u6301 watcher  \u62bd\u8c61\\n\\n\u9664\u4e86\u793e\u533a\u7684 casbin-redis-watcher\uff0c\u6211\u4eec\u4e5f\u63d0\u4f9b\u4e86\u590d\u7528 redis \u8fde\u63a5\u7684 watcher\uff0c\u4e3a\u4e86\u51cf\u5c11\u5305\uff0c\u540e\u7eed\u6240\u6709\u7684 casbin/redis \u76f8\u5173\u7684\u529f\u80fd\u90fd\u5c06\u590d\u7528 `casbin-redis-adapter` \u5305\u3002\\n\\n\u4f7f\u7528\u793a\u4f8b\uff1a\\n\\n```typescript\\nimport { MidwayAppInfo } from \'@midwayjs/core\';\\nimport { join } from \'path\';\\nimport { createAdapter, createWatcher } from \'@midwayjs/casbin-redis-adapter\';\\n\\nexport default (appInfo: MidwayAppInfo) => {\\n  return {\\n    keys: \'123456\',\\n    redis: {\\n      clients: {\\n        \'node-casbin-official\': {\\n          host: \'127.0.0.1\',\\n          port: 6379,\\n          password: \'\',\\n          db: \'0\',\\n        },\\n        \'node-casbin-sub\': {\\n          host: \'127.0.0.1\',\\n          port: 6379,\\n          password: \'\',\\n          db: \'0\',\\n        }\\n      }\\n    },\\n    casbin: {\\n      // ...\\n      policyAdapter: createAdapter({\\n        clientName: \'node-casbin-official\'\\n      }),\\n      policyWatcher: createWatcher({\\n        pubClientName: \'node-casbin-official\',\\n        subClientName: \'node-casbin-sub\',\\n      })\\n    },\\n  };\\n}\\n\\n```\\n\\n\u7531\u4e8e pub/sub \u8fde\u63a5\u9700\u8981\u4e0d\u540c\uff0c\u8fd9\u91cc\u5b9a\u4e49\u4e86\u4e24\u4e2a\u5ba2\u6237\u7aef\uff0c\u548c adapter \u5b58\u50a8\u590d\u7528\u5176\u4e2d\u4e00\u4e2a\u8fde\u63a5\u3002\\n\\n\\n\\n### 4\u3001DataSource \u7684\u4e0d\u540c\u8def\u5f84\u652f\u6301\\n\\n\u4e3a\u4e86\u89e3\u51b3\u4e0d\u540c\u7528\u6237\u7684\u4f7f\u7528\u4e60\u60ef\uff0c\u6211\u4eec\u652f\u6301\u4e86\u5927\u591a\u6570\u53ef\u80fd\u7684\u901a\u914d\u5f62\u5f0f\uff0c\u73b0\u5728\u4f60\u53ef\u4ee5\u5728 DataSource \u4e2d\u4f7f\u7528\u5f88\u591a\u4ee5\u524d\u7684\u683c\u5f0f\u3002\\n\\n\u6bd4\u5982\uff1a\\n\\n```typescript\\nexport default {\\n  mysql: {\\n    dataSource: {\\n      dataSource1: {\\n        // ...\\n        entities: [\\n          \'entity\',             // \u7279\u5b9a\u76ee\u5f55\\n          \'**/abc/**\',          // \u4ec5\u83b7\u53d6\u5305\u542b abc \u5b57\u7b26\u7684\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\\n          \'abc/**/*.ts\',        // \u7279\u5b9a\u76ee\u5f55 + \u901a\u914d\\n          \'abc/*.entity.ts\',    // \u5339\u914d\u540e\u7f00\\n          \'**/*.entity.ts\',     // \u901a\u914d\u52a0\u540e\u7f00\u5339\u914d\\n          \'**/*.{j,t}s\',        // \u540e\u7f00\u5339\u914d\\n        ]\\n      },\\n      // ...\\n      // ...\\n    }\\n  }\\n}\\n```"},{"id":"release/3.8.0","metadata":{"permalink":"/en/blog/release/3.8.0","source":"@site/blog/2022-11-18-release-3-8.md","title":"Release 3.8.0","description":"v3.8.0 \u662f\u5728\u7ecf\u8fc7\u5927\u4fc3\u4e4b\u540e\u7684\u7b2c\u4e00\u4e2a minor \u7248\u672c\uff0c\u79ef\u6512\u4e86\u5f88\u591a\u65b0\u7684\u80fd\u529b\u3002","date":"2022-11-18T00:00:00.000Z","formattedDate":"November 18, 2022","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":2.93,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.8.0","title":"Release 3.8.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"Release 3.9.0","permalink":"/en/blog/release/3.9.0"},"nextItem":{"title":"\u79fb\u9664 node v12 \u76f8\u5173\u7684\u4f9d\u8d56","permalink":"/en/blog/remove-node-v12"}},"content":"v3.8.0 \u662f\u5728\u7ecf\u8fc7\u5927\u4fc3\u4e4b\u540e\u7684\u7b2c\u4e00\u4e2a minor \u7248\u672c\uff0c\u79ef\u6512\u4e86\u5f88\u591a\u65b0\u7684\u80fd\u529b\u3002\\n\\n\u5347\u7ea7\u8bf7\u53c2\u8003  [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\\n## Features\\n\\n### 1\u3001etcd \u7ec4\u4ef6\\n\\n\u65b0\u589e\u4e86\u4e00\u4e2a etcd \u7ec4\u4ef6\uff0c\u65b9\u4fbf\u7528\u6237\u4f7f\u7528\uff0c\u6587\u6863\u7a0d\u540e\u63d0\u4f9b\u3002\\n\\n```typescript\\nimport { ETCDService } from \'@midwayjs/etcd\';\\n\\n@Provide()\\nexport class UserService {\\n  \\n  @Inject()\\n  etcdService: ETCDService;\\n\\n  async invoke() {\\n\\n    const fooValue = await this.etcdService.get(\'foo\').string();\\n    console.log(\'foo was:\', fooValue);\\n    // ...\\n  }\\n}\\n```\\n\\n\u66f4\u591a\u7ec6\u8282\u8bf7\u67e5\u770b [\u6587\u6863](/docs/extensions/etcd)\u3002\\n\\n### 2\u3001ServiceFactory \u652f\u6301\u8bbe\u7f6e\u9ed8\u8ba4\u5ba2\u6237\u7aef\\n\\nServiceFactory \u63d0\u4f9b\u4e86\u6807\u51c6\u7684\u591a\u5ba2\u6237\u7aef\u80fd\u529b\uff0c\u5728\u9ed8\u8ba4\u7684\u5ba2\u6237\u7aef\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u975e default \u7684\u5ba2\u6237\u7aef\u4f5c\u4e3a\u9ed8\u8ba4\u5ba2\u6237\u7aef\u6765\u4f7f\u7528\u3002\\n\\n\u8fd9\u9879\u80fd\u529b\u652f\u6301 ServiceFactory \u6269\u5c55\u51fa\u6765\u7684\u6240\u6709\u7ec4\u4ef6\uff0c\u5305\u62ec axios/cos/oss/redis/tablestore \u7b49\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u7ec4\u4ef6\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u9002\u914d\u4eab\u53d7\u5230\u8be5\u80fd\u529b\u3002\\n\\n\u6bd4\u5982\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u591a\u4e2a redis \u5ba2\u6237\u7aef\u3002\\n\\n\\n```typescript\\nexport default {\\n  // ...\\n  redis: {\\n    clients: {\\n      default: {\\n        // ...\\n      },\\n      default2: {\\n        // ...\\n      },\\n    },\\n  },\\n}\\n```\\n\\n\u9ed8\u8ba4\u6ce8\u5165\u7684 `RedisService` \u6c38\u8fdc\u4e3a `default` \u6307\u5411\u7684\u5ba2\u6237\u7aef\uff0c\u800c\u65b0\u7248\u672c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u9ed8\u8ba4\u7684\u5ba2\u6237\u7aef\u540d\uff0c\u6765\u9009\u62e9\u9ed8\u8ba4\u7684\u5ba2\u6237\u7aef\u3002\\n\\n\u6bd4\u5982\uff1a\\n\\n```typescript\\nexport default {\\n  // ...\\n  redis: {\\n    clients: {\\n      default: {\\n        // ...\\n      },\\n      default2: {\\n        // ...\\n      },\\n    },\\n    defaultClientName: \'default2\'\\n  },\\n}\\n```\\n\\n\u90a3\u4e48\u5b9e\u9645\u83b7\u53d6\u7684 `redisService` \u4e2d\u662f `default2` \u8fd9\u4e2a\u5b9e\u4f8b\u3002\\n\\n```typescript\\n\\n@Provide()\\nexport class UserService {\\n\\n  @Inject()\\n  redisService: RedisService;\\n\\n  async invoke() {\\n    // this.redisService \u4e2d\u5305\u88f9\u7684\u662f default2\\n  }\\n}\\n```\\n\\n\\n\\n### 3\u3001\u6570\u636e\u6e90\u7c7b\u578b\u589e\u52a0 `@InjectDataSource` \u88c5\u9970\u5668\\n\\n\u4e3a\u4e86\u7b80\u5316\u83b7\u53d6\u6570\u636e\u6e90\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u65b0\u7684 `@InjectDataSource` \u88c5\u9970\u5668\uff0c\u652f\u6301 mikro/sequelize/typeorm\u3002\\n\\n\u6bd4\u5982\uff1a\\n\\n```typescript\\nimport { InjectDataSource } from \'@midwayjs/typeorm\';\\nimport { DataSource, Repository } from \'typeorm\';\\n\\n@Provide()\\nexport class UserService {\\n  \\n  @InjectDataSource()\\n  defaultDataSource: DataSource;\\n\\n  async invoke() {\\n\\n    // ...\\n  }\\n}\\n```\\n\\n\u4e5f\u53ef\u4ee5\u6307\u5b9a\u6570\u636e\u6e90\u3002\\n\\n```typescript\\nimport { InjectDataSource } from \'@midwayjs/typeorm\';\\nimport { DataSource, Repository } from \'typeorm\';\\n\\n@Provide()\\nexport class UserService {\\n  \\n  @InjectDataSource(\'default\')\\n  defaultDataSource: DataSource;\\n\\n  async invoke() {\\n    // ...\\n  }\\n}\\n```\\n\\n\\n\\n## Bugfix\\n\\n\\n\\n- 1\u3001\u4fee\u590d windows \u4e0b entity \u901a\u914d\u626b\u63cf\uff0c\u4e4b\u524d windows \u4e0b\u7684 entity \u5982\u679c\u4f7f\u7528\u4e86\u901a\u914d\u7b26\uff0c\u4f1a\u626b\u63cf\u5931\u8d25\uff0c\u5bfc\u81f4 entity \u65e0\u6cd5\u6b63\u786e\u7684\u52a0\u5165\u5230\u6570\u636e\u6e90\u4e2d\uff0c\u65b0\u7248\u672c\u4fee\u590d\u4e86\u8be5\u95ee\u9898\u3002\\n- 2\u3001bull \u7684 Queue \u5b9a\u4e49\u5904\u7406\u95ee\u9898\uff0c\u73b0\u5728\u6587\u6863\u5df2\u7ecf\u505a\u4e86\u4fee\u6539\uff0c\u6ce8\u5165\u7684\u7c7b\u578b\u53ef\u4ee5\u7531 `IQueue` \u53d8\u4e3a `BullQueue`\u3002\\n\\n\\n\\n## Performance\\n\\n\u79fb\u9664\u4e86 babel \u7f16\u8bd1\u51fa\u7684 class \u7684\u517c\u5bb9\u5224\u65ad\uff0c\u6846\u67b6\u6574\u4f53\u6027\u80fd\u63d0\u5347\u7ea6\u4e00\u500d\u3002"},{"id":"remove-node-v12","metadata":{"permalink":"/en/blog/remove-node-v12","source":"@site/blog/2022-11-04-remove-node-v12.md","title":"\u79fb\u9664 node v12 \u76f8\u5173\u7684\u4f9d\u8d56","description":"\u7531\u4e8e\u6700\u8fd1 node v18 \u6807\u8bb0\u4e3a LTS\uff0c\u793e\u533a\u76f8\u5173\u7684\u76f8\u5173\u7684\u4f9d\u8d56\u90fd\u79fb\u9664\u4e86 node v12 \u7684\u652f\u6301\uff0c\u5bfc\u81f4 Midway \u7684\u57fa\u5efa\uff0c\u5355\u6d4b\u5df2\u7ecf\u65e0\u6cd5\u6b63\u5e38\u7684\u6267\u884c\u3002","date":"2022-11-04T00:00:00.000Z","formattedDate":"November 4, 2022","tags":[{"label":"node","permalink":"/en/blog/tags/node"}],"readingTime":1.075,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"remove-node-v12","title":"\u79fb\u9664 node v12 \u76f8\u5173\u7684\u4f9d\u8d56","authors":["harry"],"tags":["node"]},"prevItem":{"title":"Release 3.8.0","permalink":"/en/blog/release/3.8.0"},"nextItem":{"title":"Release 3.7.0","permalink":"/en/blog/release/3.7.0"}},"content":"\u7531\u4e8e\u6700\u8fd1 node v18 \u6807\u8bb0\u4e3a LTS\uff0c\u793e\u533a\u76f8\u5173\u7684\u76f8\u5173\u7684\u4f9d\u8d56\u90fd\u79fb\u9664\u4e86 node v12 \u7684\u652f\u6301\uff0c\u5bfc\u81f4 Midway \u7684\u57fa\u5efa\uff0c\u5355\u6d4b\u5df2\u7ecf\u65e0\u6cd5\u6b63\u5e38\u7684\u6267\u884c\u3002\\n\\n\u867d\u7136 Midway \u6846\u67b6\u672c\u8eab\u652f\u6301\u5728 Node v12 \u4e0b\u8fd0\u884c\uff0c\u4f46\u662f\u4f8b\u5982 jest \u7b49\u5de5\u5177\u7684\u6700\u65b0\u7248\u672c\u5df2\u7ecf\u65e0\u6cd5\u6267\u884c\u3002\u7ecf\u8fc7\u5185\u90e8\u8ba8\u8bba\u540e\u51b3\u5b9a\uff0c\u5728 Github Action \u4e2d\u79fb\u9664 Midway \u4ee5\u53ca\u76f8\u5173\u5e93\u7684 Node v12 \u7684\u5355\u6d4b\uff0c\u4e3a\u6b64\uff0c\u76f8\u5173\u7684\u4f9d\u8d56\u4f1a\u8fdb\u884c\u8c03\u6574\uff0c\u5305\u62ec\uff1a\\n\\n- 1\u3001\u811a\u624b\u67b6\u7684\u53d8\u66f4\\n  - `@midwayjs/cli` \u5347\u7ea7\u4e3a `^2.0.0`\\n  - `jest` \uff0c`@types/jest`\uff0c`ts-jest` \u5347\u7ea7\u4e3a v29 \u7248\u672c\\n  - typescript \u5347\u7ea7\u4e3a `4.8.x`\\n- 2\u3001Midway \u672c\u8eab\\n  - \u79fb\u9664 node v12 \u7684 github action \u6267\u884c\\n  - \u9274\u4e8e\u90e8\u5206\u73af\u5883\u7684\u60c5\u51b5\uff0c\u7ee7\u7eed\u7ecf\u9a8c\u652f\u6301 node v12 \u7684\u8fd0\u884c\uff0c\u6709 node v12 \u7684\u95ee\u9898\u53ef\u4ee5 issue \u63d0\u95ee\\n\\n\\n\\n\u4f9d\u8d56\u7684\u53d8\u66f4\u53ef\u4ee5\u53c2\u8003\uff1a\\n\\n```json\\n\\"devDependencies\\": {\\n  \\"@midwayjs/cli\\": \\"^2.0.0\\",\\n  \\"@types/jest\\": \\"^29.2.0\\",\\n  \\"jest\\": \\"^29.2.2\\",\\n  \\"ts-jest\\": \\"^29.0.3\\",\\n  \\"typescript\\": \\"~4.8.0\\"\\n}\\n```"},{"id":"release/3.7.0","metadata":{"permalink":"/en/blog/release/3.7.0","source":"@site/blog/2022-10-29-release-3-7.md","title":"Release 3.7.0","description":"Features","date":"2022-10-29T00:00:00.000Z","formattedDate":"October 29, 2022","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":2.585,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.7.0","title":"Release 3.7.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"\u79fb\u9664 node v12 \u76f8\u5173\u7684\u4f9d\u8d56","permalink":"/en/blog/remove-node-v12"},"nextItem":{"title":"Jest v29 \u66f4\u65b0","permalink":"/en/blog/jest_update"}},"content":"## Features\\n\\n### 1\u3001\u652f\u6301\u4e86\u81ea\u5b9a\u4e49\u7684 web \u53c2\u6570\u88c5\u9970\u5668\\n\\n\u5728 Web \u573a\u666f\u4e0b\uff0c\u6211\u4eec\u5df2\u7ecf\u6709 `@Query`\uff0c`@Body` \u7b49\u53c2\u6570\u88c5\u9970\u5668\uff0c\u4f46\u662f\u7528\u4e8e\u4f9d\u65e7\u6709\u81ea\u5b9a\u4e49\u7684\u9700\u6c42\uff0c\u5982\u679c\u8fd9\u4e2a\u65f6\u5019\u901a\u8fc7\u73b0\u6709\u7684\u53c2\u6570\u88c5\u9970\u5668\u53bb\u5b9a\u4e49\u4f1a\u8f83\u4e3a\u7e41\u7410\u3002\\n\\n\u65b0\u7248\u672c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5feb\u901f\u5b9a\u4e49\u88c5\u9970\u5668\u7684\u80fd\u529b\uff0c\u4ece\u800c\u53ef\u4ee5\u5feb\u901f\u83b7\u53d6 ctx \u5c5e\u6027\u3002\\n\\n```typescript\\nimport { createRequestParamDecorator } from \'@midwayjs/core\';\\n\\n// \u5b9e\u73b0\u88c5\u9970\u5668\\nexport const Token = createRequestParamDecorator(ctx => {\\n  return ctx.headers.token;\\n});\\n\\n// \u4f7f\u7528\u88c5\u9970\u5668\\nexport class UserController {\\n  async invoke(@Token() token: string) {\\n    console.log(token);\\n  }\\n}\\n```\\n\\n### 2\u3001koa \u7ec4\u4ef6\u65b0\u589e `serverTimeout` \u914d\u7f6e\\n\\n\u901a\u8fc7\u914d\u7f6e `serverTimeout` \u7684\u503c\uff0c\u53ef\u4ee5\u5b9a\u4e49\u670d\u52a1\u7aef\u8d85\u65f6\u65f6\u95f4\u3002\\n\\n\u6bd4\u5982 1s \u8d85\u65f6\u3002\\n\\n```typescript\\nexport const koa = {\\n  serverTimeout: 1000,\\n}\\n```\\n\\n### 3\u3001\u591a\u6570\u636e\u6e90\u65f6\u63d0\u4f9b\u4e00\u4e2a\u9ed8\u8ba4\u6570\u636e\u6e90\u7684\u9009\u9879\\n\\n\u539f\u6709 typeorm \u7b49\u6570\u636e\u5e93\uff0c\u5982\u679c\u6307\u5b9a\u4e86\u591a\u4e2a\u6570\u636e\u6e90\uff0c\u4f1a\u9ed8\u8ba4\u4ee5\u6700\u540e\u4e00\u4e2a\u914d\u7f6e\u7684\u6570\u636e\u6e90\u4f5c\u4e3a\u9ed8\u8ba4\u6570\u636e\u6e90\u3002\\n\\n\u9ed8\u8ba4\u6570\u636e\u6e90\u5728 `InjectEntityModel` \u65f6\u53ef\u4ee5\u4e0d\u6307\u5b9a\u540d\u5b57\u3002\\n\\n\u65b0\u7248\u672c\u53ef\u4ee5\u901a\u8fc7\u663e\u5f0f\u7684\u914d\u7f6e\u9ed8\u8ba4\u6570\u636e\u6e90\uff0c\u4f7f\u5f97\u8fd9\u4e2a\u884c\u4e3a\u66f4\u53ef\u63a7\u3002\\n\\n\u6bd4\u5982\uff1a\\n\\n```typescript\\n// config.default.ts\\nexport const typeorm = {\\n  dataSource: {\\n    abc: {},\\n    bcd: {}\\n  },\\n  defaultDataSourceName: \'bcd\',\\n}\\n```\\n\\n\u8fd9\u6837\u5728\u4f7f\u7528\u65f6\uff0c\u5982\u679c\u4e0d\u6307\u5b9a `InjectEntityModel` \u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u5219\u4f1a\u5728 `bcd` \u8fd9\u4e2a dataSource \u4e2d\u67e5\u8be2 Entity\u3002\\n\\n\\n\\n### 3\u3001\u65b0\u589e\u4e86\u9a8c\u8bc1\u7801\u7ec4\u4ef6\\n\\n\\n\u901a\u8fc7\u65b0\u589e\u7684\u9a8c\u8bc1\u7801\u7ec4\u4ef6\uff0c\u53ef\u4ee5\u751f\u6210\u5728\u767b\u5f55\u4e2d\u5e38\u89c1\u7684\u56fe\u7247\uff0c\u8ba1\u7b97\u8868\u8fbe\u5f0f\u7b49\u7c7b\u578b\u7684\u9a8c\u8bc1\u7801\u3002\\n\\n\u6548\u679c\u5982\u4e0b\uff1a\\n\\n![](https://gw.alicdn.com/imgextra/i4/O1CN014cEzLH23vEniOgoyp_!!6000000007317-2-tps-120-40.png)\\n\\n\\n## Bugfix\\n\\n\u4fee\u590d\u4e86\u4e00\u4e2a import \u987a\u5e8f\u4e0d\u4e00\u81f4\uff0c\u5bfc\u81f4\u4e3b\u6846\u67b6\u83b7\u53d6\u9519\u8bef\u7684\u60c5\u51b5\u3002\\n\\n\u6bd4\u5982\uff1a\\n\\n```ts\\nimport * as bull from \'@midwayjs/bull\';\\nimport * as koa from \'@midwayjs/koa\';\\n\\n@Configuration({\\n\\timports: [koa, bull]\\n})\\nexport class MainConfiguration {}\\n```\\n\\n\u7531\u4e8e\u5185\u90e8\u521d\u59cb\u5316\u662f\u4f7f\u7528 require \u7684\u5c5e\u6027\uff0c\u5373\u4f7f imports \u7684\u987a\u5e8f\u56fa\u5b9a\uff0c\u5b9e\u9645 bull \u7684 application \u8fd8\u662f\u4f1a\u53d8\u4e3a mainApp\uff0c\u8fd9\u4e2a\u65f6\u5019\u53bb\u5f15\u5165\u4e2d\u95f4\u4ef6\uff0c\u90fd\u4f1a\u52a0\u5230 bull \u4e0a\uff0c\u800c\u4e0d\u662f koa \u4e0a\u3002\\n\\n\\n## \u5176\u4ed6\u7684\u66f4\u65b0\\n\\n- **prometheus** \u652f\u6301\u7528\u6237\u5b9a\u4e49 Histogram\\n- **faas** \u8c03\u6574\u4e86 `triggerFunction` \u65b9\u6cd5\u7684\u53c2\u6570\\n- \u5e38\u6001\u5316\u4f9d\u8d56\u5347\u7ea7"},{"id":"jest_update","metadata":{"permalink":"/en/blog/jest_update","source":"@site/blog/2022-10-29-update-jest.md","title":"Jest v29 \u66f4\u65b0","description":"\u6700\u8fd1\u7531\u4e8e axios \u7ec4\u4ef6\u7684\u5347\u7ea7\uff0c\u53ef\u80fd\u5728\u5355\u6d4b\u65f6\u4f1a\u51fa\u73b0\u4e0b\u9762\u7684\u62a5\u9519\u3002","date":"2022-10-29T00:00:00.000Z","formattedDate":"October 29, 2022","tags":[{"label":"\u66f4\u65b0","permalink":"/en/blog/tags/\u66f4\u65b0"},{"label":"jest","permalink":"/en/blog/tags/jest"}],"readingTime":0.53,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"jest_update","title":"Jest v29 \u66f4\u65b0","authors":["harry"],"tags":["\u66f4\u65b0","jest"]},"prevItem":{"title":"Release 3.7.0","permalink":"/en/blog/release/3.7.0"},"nextItem":{"title":"core \u548c decorator \u5305\u5408\u5e76\u7684\u5f71\u54cd","permalink":"/en/blog/core-decorator-merge"}},"content":"\u6700\u8fd1\u7531\u4e8e axios \u7ec4\u4ef6\u7684\u5347\u7ea7\uff0c\u53ef\u80fd\u5728\u5355\u6d4b\u65f6\u4f1a\u51fa\u73b0\u4e0b\u9762\u7684\u62a5\u9519\u3002\\n\\n![](https://img.alicdn.com/imgextra/i2/O1CN01G4Ze0F1qVxwcNwYeF_!!6000000005502-2-tps-2080-1158.png)\\n\\n\u539f\u56e0\u4e3a\u811a\u624b\u67b6\u81ea\u5e26\u7684 jest v26 \u4e0d\u652f\u6301 package.json \u4e2d\u7684 `exports` \u903b\u8f91\u3002\\n\\n\u89e3\u51b3\u65b9\u6cd5\uff1a\\n\\n- 1\u3001\u5c06 `package.json` \u4e2d\u7684 jest \u7248\u672c\u4ece v26 \u66f4\u65b0\u4e3a v29\\n- 2\u3001\u5c06 `@midwayjs/cli` \u7684\u7248\u672c\u5347\u7ea7\u4e3a `1.3.16` \u7248\u672c\u4ee5\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u5347\u7ea7\u5230 `2.0`\\n\\n\u793a\u4f8b\u5982\u4e0b\uff1a\\n\\n```json\\n{\\n  \\"devDependencies\\": {\\n    \\"@midwayjs/cli\\": \\"^2.0.1\\",\\n    \\"@types/jest\\": \\"^29.2.0\\",\\n    \\"jest\\": \\"^29.2.2\\",\\n    \\"ts-jest\\": \\"^29.0.3\\",\\n    // ...\\n  }\\n}\\n```"},{"id":"core-decorator-merge","metadata":{"permalink":"/en/blog/core-decorator-merge","source":"@site/blog/2022-10-26-core-decorator-merge.md","title":"core \u548c decorator \u5305\u5408\u5e76\u7684\u5f71\u54cd","description":"\u4ece v3.6.0 \u5f00\u59cb\uff0cMidway \u5728\u4ee3\u7801\u5c42\u9762\u5c06 @midwayjs/decorator \u4e2d\u7684\u4ee3\u7801\u8fc1\u79fb\u5230\u4e86 @midwayjs/core \u4e2d\uff0c\u672a\u6765 @midwayjs/decorator \u5305\u5c06\u9010\u6b65\u51cf\u5c11\u4f7f\u7528\u3002","date":"2022-10-26T00:00:00.000Z","formattedDate":"October 26, 2022","tags":[{"label":"decorator","permalink":"/en/blog/tags/decorator"},{"label":"core","permalink":"/en/blog/tags/core"}],"readingTime":1.62,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"core-decorator-merge","title":"core \u548c decorator \u5305\u5408\u5e76\u7684\u5f71\u54cd","authors":["harry"],"tags":["decorator","core"]},"prevItem":{"title":"Jest v29 \u66f4\u65b0","permalink":"/en/blog/jest_update"},"nextItem":{"title":"Release 3.6.0","permalink":"/en/blog/release/3.6.0"}},"content":"\u4ece v3.6.0 \u5f00\u59cb\uff0cMidway \u5728\u4ee3\u7801\u5c42\u9762\u5c06 `@midwayjs/decorator` \u4e2d\u7684\u4ee3\u7801\u8fc1\u79fb\u5230\u4e86 `@midwayjs/core` \u4e2d\uff0c\u672a\u6765 `@midwayjs/decorator` \u5305\u5c06\u9010\u6b65\u51cf\u5c11\u4f7f\u7528\u3002\\n\\n`@midwayjs/decorator` \u4e2d\u7684\u4ee3\u7801\u5168\u90e8\u4ece `@midwayjs/core` \u4e2d\u4ee3\u7406\u51fa\u6765\uff0c\u4ee3\u7801\u5c42\u9762\u4fdd\u6301\u5411\u4e0b\u517c\u5bb9\u3002\\n\\n\u6700\u8fd1\u53d1\u73b0\u6709\u4e9b\u7528\u6237\u4f1a\u51fa\u73b0\u7c7b\u4f3c\u4e0b\u9762\u7684\u62a5\u9519\uff1a\\n\\n![](https://img.alicdn.com/imgextra/i3/O1CN01ZUf1P31oSBRQlBEhv_!!6000000005223-0-tps-3148-554.jpg)\\n\\n\u539f\u56e0\u6709\u4e24\u7c7b\uff1a\\n\\n**1\u3001v3 \u7684\u7248\u672c\u7684 core \u548c\u7ec4\u4ef6\u7248\u672c\u4e0d\u4e00\u81f4**\\n\\n\u5728\u5f00\u53d1\u65f6\uff0c\u76f4\u63a5\u4f7f\u7528 `npm install` \u800c\u5b89\u88c5\u4e86 latest \u7248\u672c\uff08>=v3.6.0\uff09 \u7684\u7ec4\u4ef6\u3002\\n\\n\u7531\u4e8e core \u7684\u7248\u672c\u4f9d\u65e7\u5728 `3.6.0` \u4ee5\u4e0b\uff0c\u4f46\u662f\u7ec4\u4ef6\u4f9d\u8d56\u4e86\u6700\u65b0\u7248\u672c core \u7684 API\uff0c\u4ece\u800c\u62a5\u9519\u3002\\n\\n\u6211\u4eec\u5728\u6587\u6863 [\u5982\u4f55\u66f4\u65b0 Midway](/docs/how_to_update_midway) \u4e2d\u6709\u63cf\u8ff0\uff0c\u8bf7\u4e0d\u8981\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7ec4\u4ef6\u5305\u3002\\n\\n\u89e3\u51b3\u65b9\u6848\u6709\u4e24\u4e2a\uff1a\\n\\n- 1\u3001\u53ef\u4ee5\u4f7f\u7528\u4f4e\u7248\u672c\u7684\u7ec4\u4ef6\uff0c\u6bd4\u5982 `3.6.0` \u4ee5\u4e0b\\n- 2\u3001\u6216\u8005\u5347\u7ea7 core \u548c\u5176\u4ed6\u7684\u7248\u672c\u7edf\u4e00\u5230  `3.6.0` \u4ee5\u4e0a\\n\\n\\n\\n**2\u3001v2 \u7684\u7248\u672c\u4f7f\u7528\u4e86 v3 \u7684\u7ec4\u4ef6**\\n\\n\u5728 v2 \u7248\u672c\u65f6\uff0c\u76f4\u63a5\u4f7f\u7528 `npm install` \u800c\u9519\u8bef\u5b89\u88c5\u4e86 latest \u7248\u672c\uff08v3\uff09 \u7684\u7ec4\u4ef6\u3002\\n\\n\u6211\u4eec\u4e3a\u4e86\u9002\u914d\u6700\u65b0\u7684\u7248\u672c\u6b63\u597d\u5347\u7ea7\u4e86 v3 \u7684\u7ec4\u4ef6\uff0c\u4ece\u800c\u66b4\u9732\u4e86\u5f15\u4e86\u9519\u8bef\u7684\u7248\u672c\u7684\u8fd9\u4e2a\u95ee\u9898\u3002\\n\\n\u73b0\u5728 v2 \u548c v3 \u7684\u7ec4\u4ef6\u4e0d\u4fdd\u8bc1\u80fd\u5b8c\u5168\u517c\u5bb9\uff0c\u6240\u4ee5\u8bf7\u5728\u5b89\u88c5\u65f6\u505a\u597d\u533a\u5206\u3002\\n\\n\u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528 v2 \u7248\u672c\u7684\u7ec4\u4ef6\u3002"},{"id":"release/3.6.0","metadata":{"permalink":"/en/blog/release/3.6.0","source":"@site/blog/2022-10-12-release-3-6.md","title":"Release 3.6.0","description":"v3.6.0 \u5305\u542b\u4e00\u4e2a\u91cd\u5927\u7684 \u91cd\u6784\uff0c\u6211\u4eec\u5c06 @midwayjs/decorator \u5305\u548c @midwayjs/core \u5305\u7684\u5185\u5bb9\u8fdb\u884c\u4e86\u6574\u5408\uff0c\u672a\u6765\u6240\u6709\u7684 decorator \u76f8\u5173\u7684\u5185\u5bb9\uff0c\u90fd\u4f1a\u7531 @midwayjs/core \u5bfc\u51fa\uff0c@midwayjs/decorator \u5305\u4ec5\u505a\u4ee3\u7406\uff0c\u4fdd\u6301\u529f\u80fd\u517c\u5bb9\u3002","date":"2022-10-12T00:00:00.000Z","formattedDate":"October 12, 2022","tags":[{"label":"release","permalink":"/en/blog/tags/release"}],"readingTime":2.19,"hasTruncateMarker":false,"authors":[{"name":"Harry Chen","title":"Maintainer of Midway","url":"https://github.com/czy88840616","imageURL":"https://avatars.githubusercontent.com/u/418820","key":"harry"}],"frontMatter":{"slug":"release/3.6.0","title":"Release 3.6.0","authors":["harry"],"tags":["release"]},"prevItem":{"title":"core \u548c decorator \u5305\u5408\u5e76\u7684\u5f71\u54cd","permalink":"/en/blog/core-decorator-merge"}},"content":"v3.6.0 \u5305\u542b\u4e00\u4e2a\u91cd\u5927\u7684 [\u91cd\u6784](https://github.com/midwayjs/midway/issues/2258)\uff0c\u6211\u4eec\u5c06 @midwayjs/decorator \u5305\u548c @midwayjs/core \u5305\u7684\u5185\u5bb9\u8fdb\u884c\u4e86\u6574\u5408\uff0c\u672a\u6765\u6240\u6709\u7684 decorator \u76f8\u5173\u7684\u5185\u5bb9\uff0c\u90fd\u4f1a\u7531 @midwayjs/core \u5bfc\u51fa\uff0c@midwayjs/decorator \u5305\u4ec5\u505a\u4ee3\u7406\uff0c\u4fdd\u6301\u529f\u80fd\u517c\u5bb9\u3002\\n\u540e\u7eed\uff0c\u6211\u4eec\u5c06\u4f1a\u5728\u6587\u6863\u4e0a\u8fdb\u884c decorator \u5305\u7684\u79fb\u9664\u64cd\u4f5c\uff0c\u5728\u8fd9\u6bb5\u65f6\u95f4\u4e2d\uff0c\u5927\u5bb6\u8fd8\u662f\u4f1a\u770b\u5230 decorator \u548c core \u5e76\u5b58\u7684\u60c5\u51b5\u3002\\n\\n## Features\\n\\n### 1\u3001\u5b88\u536b\\n\\n\u4ece v3.6.0 \u7248\u672c\u5f00\u59cb\uff0c\u6211\u4eec\u63d0\u4f9b\u4e86\u5b88\u536b\u80fd\u529b\uff0c\u548c middleare\uff0cfilter \u7c7b\u4f3c\uff0c\u4e5f\u662f\u4e00\u4e2a\u5168\u6846\u67b6\u590d\u7528\u7684\u80fd\u529b\uff08koa/egg/grpc/rabbitmq/bull \u7b49\uff09\\n\\n```typescript\\nimport { IMiddleware, Guard, IGuard } from \'@midwayjs/core\';\\nimport { Context } from \'@midwayjs/koa\';\\n\\n@Guard()\\nexport class AuthGuard implements IGuard<Context> {\\n  async canActivate(context: Context, suppilerClz, methodName: string): Promise<boolean> {\\n    // ...\\n  }\\n}\\n```\\n\u66f4\u591a\u7ec6\u8282\u8bf7\u67e5\u770b [\u6587\u6863](/docs/guard)\u3002\\n\\n\\n### 2\u3001\u9274\u6743\\n\\n\u57fa\u4e8e\u5b88\u536b\u529f\u80fd\u7684\u5b8c\u6210\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49 @Role \u88c5\u9970\u5668\u6765\u5b8c\u6210\u7b80\u5355\u7684\u89d2\u8272\u9274\u6743\uff0c\u540c\u65f6\u6211\u4eec\u4e5f\u5c01\u88c5\u4e86 casbin \u8fd9\u4e00\u5728\u793e\u533a\u8f83\u4e3a\u901a\u7528\u7684\u9274\u6743\u7ec4\u4ef6\uff0c\u65b9\u4fbf\u5927\u5bb6\u4f7f\u7528\u3002\\n\\n\u6bd4\u5982\uff0c\u901a\u8fc7\u88c5\u9970\u5668\u9274\u6743\u3002\\n\\n\\n```typescript\\nimport { Controller, Get, UseGuard } from \'@midwayjs/decorator\';\\nimport { AuthActionVerb, AuthGuard, AuthPossession, UsePermission } from \'@midwayjs/casbin\';\\nimport { Resource } from \'./resouce\';\\n\\n@Controller(\'/\')\\nexport class HomeController {\\n\\n  @UseGuard(AuthGuard)\\n  @UsePermission({\\n    action: AuthActionVerb.READ,\\n    resource: Resource.USER_ROLES,\\n    possession: AuthPossession.ANY\\n  })\\n  @Get(\'/users\')\\n  async findAllUsers() {\\n    // ...\\n  }\\n}\\n```\\n\\ncasbin \u7ec4\u4ef6\u76ee\u524d\u5b9e\u73b0\u4e86 redis \u548c typeorm \u4e24\u4e2a\u53ef\u4ee5\u590d\u7528\u7684\u9002\u914d\u5668\u4f9b\u5927\u5bb6\u9009\u62e9\uff0c\u5982\u6709\u5176\u4ed6\u9700\u6c42\uff0c\u53ef\u4ee5\u989d\u5916\u8fdb\u884c\u9002\u914d\u3002\\n\\n\u66f4\u591a\u7ec6\u8282\uff0c\u53ef\u4ee5\u67e5\u770b [\u6587\u6863](/docs/extensions/casbin)\u3002\\n\\n### 3\u3001bull \u7ec4\u4ef6\\n\\n\u6211\u4eec\u65b0\u589e\u4e86 bull \u7ec4\u4ef6\u7528\u4e8e\u66ff\u4ee3\u539f\u6709\u7684 task \u7ec4\u4ef6\u3002\\n\\n```typescript\\n// invoke\\nconst testQueue = this.bullFramework.getQueue(\'test\');\\n// \u7acb\u5373\u6267\u884c\u8fd9\u4e2a\u4efb\u52a1\\nawait testQueue?.runJob({\\n  aaa: 1,\\n  bbb: 2,\\n});\\n```\\n\\n\u540c\u65f6\u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e2a bull-board \u7ec4\u4ef6\u7528\u4e8e\u7ba1\u7406\u3002\\n\\n![](https://cdn.nlark.com/yuque/0/2022/png/501408/1665641044268-8ebfc3bb-777b-43f8-a8d9-bfb77f95e47c.png)\\n\\n\u66f4\u591a\u7ec6\u8282\uff0c\u53ef\u4ee5\u67e5\u770b \u6587\u6863\u3002\\n\\n\u66f4\u591a\u4ecb\u7ecd\u53ef\u4ee5\u67e5\u770b\u6211\u4eec\u7684 [b \u7ad9\u89c6\u9891](https://www.bilibili.com/video/BV1ZB4y1j7H3/)"}]}')}}]);